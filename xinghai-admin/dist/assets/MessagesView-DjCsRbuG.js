import{d as e,a,r as l,j as t,c as s,e as d,w as u,f as i,o,b as n,h as r,k as c,l as p,g as m,P as v,Q as g,I as f,t as y,E as _,s as h,_ as b}from"./index-DdCtHfSO.js";const w={class:"messages-container"},k={class:"card-header"},T={class:"search-area"},C={class:"message-list"},V={class:"pagination-container"},x={class:"message-detail"},N={class:"message-header"},B={class:"message-meta"},q={class:"restock-info"},z={key:0,class:"resolved-info"},U={key:0},D={class:"dialog-footer"},I=b(e({__name:"MessagesView",setup(e,{expose:b}){const I=a({status:"",email:"",productName:"",dateRange:[]}),R=l(1),S=l(10),Y=l(100),j=l([{id:1,email:"newshengao@gmail.com",productName:"美国号码",quantity:10,description:"需要更多号码，越快越好",status:"pending",createTime:"2024-03-10 10:30:45"},{id:2,email:"agent001@example.com",productName:"美国号码",quantity:50,description:"客户需要美国号码，急需补货",status:"pending",createTime:"2024-03-07 16:45:10"},{id:3,email:"user123@example.com",productName:"英国号码",quantity:20,description:"需要英国号码用于业务拓展",status:"resolved",createTime:"2024-03-05 09:15:22",resolvedTime:"2024-03-05 11:30:45",resolvedBy:"管理员"},{id:4,email:"customer@example.com",productName:"加拿大号码",quantity:15,description:"客户急需加拿大号码",status:"resolved",createTime:"2024-03-03 14:20:15",resolvedTime:"2024-03-03 16:45:30",resolvedBy:"管理员"},{id:5,email:"business@example.com",productName:"澳大利亚号码",quantity:30,description:"业务扩展需要澳大利亚号码",status:"pending",createTime:"2024-03-01 11:10:05"}]),M=l([]),E=l({id:0,email:"",productName:"",quantity:0,description:"",status:"",createTime:"",resolvedTime:"",resolvedBy:""}),L=l(!1),P=()=>{_.success("搜索条件已应用"),R.value=1},Q=()=>{I.status="",I.email="",I.productName="",I.dateRange=[],P()},$=e=>{S.value=e},A=e=>{R.value=e},F=e=>{M.value=e},G=({row:e})=>"pending"===e.status?"pending-row":"",H=e=>{const a=j.value.findIndex((a=>a.id===e.id));-1!==a&&(j.value[a].status="resolved",j.value[a].resolvedTime=(new Date).toLocaleString(),j.value[a].resolvedBy="管理员",E.value.id===e.id&&(E.value.status="resolved",E.value.resolvedTime=j.value[a].resolvedTime,E.value.resolvedBy=j.value[a].resolvedBy),_.success("已标记为已解决"))},J=()=>{if(0===M.value.length)return void _.warning("请选择要标记的补货提醒");const e=M.value.map((e=>e.id)),a=(new Date).toLocaleString();j.value.forEach((l=>{e.includes(l.id)&&"pending"===l.status&&(l.status="resolved",l.resolvedTime=a,l.resolvedBy="管理员")})),_.success(`已将${e.length}条补货提醒标记为已解决`)};return t((()=>{})),b({getPendingCount:()=>j.value.filter((e=>"pending"===e.status)).length}),(e,a)=>{const l=i("el-button"),t=i("el-option"),b=i("el-select"),K=i("el-form-item"),O=i("el-input"),W=i("el-date-picker"),X=i("el-form"),Z=i("el-table-column"),ee=i("el-tag"),ae=i("el-icon"),le=i("el-button-group"),te=i("el-table"),se=i("el-pagination"),de=i("el-card"),ue=i("el-descriptions-item"),ie=i("el-descriptions"),oe=i("el-dialog");return o(),s("div",w,[d(de,{class:"box-card"},{header:u((()=>[n("div",k,[a[8]||(a[8]=n("span",null,"补货提醒",-1)),d(l,{type:"primary",onClick:J,disabled:0===M.value.length},{default:u((()=>a[7]||(a[7]=[r(" 批量标记已解决 ")]))),_:1},8,["disabled"])])])),default:u((()=>[a[13]||(a[13]=n("div",{class:"page-description"}," 管理用户发来的补货提醒，您可以查看详情并标记为已解决。 ",-1)),n("div",T,[d(X,{inline:!0,model:I,class:"search-form"},{default:u((()=>[d(K,{label:"状态"},{default:u((()=>[d(b,{modelValue:I.status,"onUpdate:modelValue":a[0]||(a[0]=e=>I.status=e),placeholder:"全部状态",clearable:""},{default:u((()=>[d(t,{label:"未解决",value:"pending"}),d(t,{label:"已解决",value:"resolved"})])),_:1},8,["modelValue"])])),_:1}),d(K,{label:"用户邮箱"},{default:u((()=>[d(O,{modelValue:I.email,"onUpdate:modelValue":a[1]||(a[1]=e=>I.email=e),placeholder:"用户邮箱"},null,8,["modelValue"])])),_:1}),d(K,{label:"商品名称"},{default:u((()=>[d(O,{modelValue:I.productName,"onUpdate:modelValue":a[2]||(a[2]=e=>I.productName=e),placeholder:"商品名称"},null,8,["modelValue"])])),_:1}),d(K,{label:"时间范围"},{default:u((()=>[d(W,{modelValue:I.dateRange,"onUpdate:modelValue":a[3]||(a[3]=e=>I.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),d(K,null,{default:u((()=>[d(l,{type:"primary",onClick:P},{default:u((()=>a[9]||(a[9]=[r("查询")]))),_:1}),d(l,{onClick:Q},{default:u((()=>a[10]||(a[10]=[r("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),n("div",C,[d(te,{data:j.value,style:{width:"100%"},onSelectionChange:F,"row-class-name":G},{default:u((()=>[d(Z,{type:"selection",width:"55"}),d(Z,{label:"状态",width:"100"},{default:u((e=>["pending"===e.row.status?(o(),c(ee,{key:0,type:"danger"},{default:u((()=>a[11]||(a[11]=[r("未解决")]))),_:1})):"resolved"===e.row.status?(o(),c(ee,{key:1,type:"success"},{default:u((()=>a[12]||(a[12]=[r("已解决")]))),_:1})):p("",!0)])),_:1}),d(Z,{prop:"email",label:"用户邮箱",width:"200"}),d(Z,{prop:"productName",label:"商品名称","min-width":"150"}),d(Z,{prop:"quantity",label:"需求数量",width:"100"}),d(Z,{prop:"description",label:"备注说明","min-width":"200"}),d(Z,{prop:"createTime",label:"发送时间",width:"180"}),d(Z,{label:"操作",width:"150",fixed:"right"},{default:u((e=>[d(le,null,{default:u((()=>[d(l,{size:"small",type:"primary",onClick:a=>{return l=e.row,E.value={...l},void(L.value=!0);var l},title:"查看详情"},{default:u((()=>[d(ae,null,{default:u((()=>[d(m(v))])),_:1})])),_:2},1032,["onClick"]),d(l,{size:"small",type:"success",onClick:a=>H(e.row),disabled:"resolved"===e.row.status,title:"标记为已解决"},{default:u((()=>[d(ae,null,{default:u((()=>[d(m(g))])),_:1})])),_:2},1032,["onClick","disabled"]),d(l,{size:"small",type:"danger",onClick:a=>{return l=e.row.id,void h.confirm("确定要删除这条补货提醒吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=j.value.findIndex((e=>e.id===l));-1!==e&&j.value.splice(e,1),_.success("删除成功")})).catch((()=>{}));var l},title:"删除"},{default:u((()=>[d(ae,null,{default:u((()=>[d(m(f))])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"])]),n("div",V,[d(se,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:Y.value,"page-size":S.value,"current-page":R.value,onSizeChange:$,onCurrentChange:A},null,8,["total","page-size","current-page"])])])),_:1}),d(oe,{modelValue:L.value,"onUpdate:modelValue":a[6]||(a[6]=e=>L.value=e),title:"补货提醒详情",width:"600px"},{footer:u((()=>[n("span",D,[d(l,{onClick:a[4]||(a[4]=e=>L.value=!1)},{default:u((()=>a[17]||(a[17]=[r("关闭")]))),_:1}),d(l,{type:"success",onClick:a[5]||(a[5]=e=>H(E.value)),disabled:"resolved"===E.value.status},{default:u((()=>a[18]||(a[18]=[r("标记为已解决")]))),_:1},8,["disabled"])])])),default:u((()=>[n("div",x,[n("div",N,[n("h3",null,"补货提醒 #"+y(E.value.id),1),n("div",B,[n("span",null,"时间: "+y(E.value.createTime),1),"pending"===E.value.status?(o(),c(ee,{key:0,type:"danger"},{default:u((()=>a[14]||(a[14]=[r("未解决")]))),_:1})):"resolved"===E.value.status?(o(),c(ee,{key:1,type:"success"},{default:u((()=>a[15]||(a[15]=[r("已解决")]))),_:1})):p("",!0)])]),n("div",q,[d(ie,{column:1,border:""},{default:u((()=>[d(ue,{label:"用户邮箱"},{default:u((()=>[r(y(E.value.email),1)])),_:1}),d(ue,{label:"商品名称"},{default:u((()=>[r(y(E.value.productName),1)])),_:1}),d(ue,{label:"需求数量"},{default:u((()=>[r(y(E.value.quantity),1)])),_:1}),d(ue,{label:"备注说明"},{default:u((()=>[r(y(E.value.description),1)])),_:1})])),_:1})]),E.value.resolvedTime?(o(),s("div",z,[a[16]||(a[16]=n("h4",null,"解决信息",-1)),n("p",null,"已于 "+y(E.value.resolvedTime)+" 标记为已解决",1),E.value.resolvedBy?(o(),s("p",U,"处理人: "+y(E.value.resolvedBy),1)):p("",!0)])):p("",!0)])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-55567233"]]);export{I as default};

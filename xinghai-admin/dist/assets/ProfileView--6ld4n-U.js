import{d as e,r as a,a as l,i as s,j as t,c as r,e as i,w as u,f as o,o as n,b as d,k as c,l as m,h as p,t as f,E as v,u as g,_ as b}from"./index-DdCtHfSO.js";const h={class:"profile-container"},_={class:"card-header"},y={key:1},w={class:"profile-content"},k={class:"avatar-container"},V={class:"info-container"},x={class:"security-list"},C={class:"security-item"},I={class:"security-item"},S={class:"security-info"},U={class:"security-item"},z=b(e({__name:"ProfileView",setup(e){const b=g(),z=a(),T=a(!1),F=a(!1),O=l({username:"admin",nickname:"管理员",email:"admin@xinghai.com",role:"超级管理员",avatar:"https://picsum.photos/200",registerTime:"2023-01-01 10:00:00",lastLoginTime:"2023-03-09 08:30:00"}),q=l({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]}),A=a([{time:"2023-03-09 08:30:00",ip:"192.168.1.1",location:"中国 广东 深圳",device:"Chrome 98.0.4758.102 / Windows 10",status:"成功"},{time:"2023-03-08 18:45:12",ip:"192.168.1.1",location:"中国 广东 深圳",device:"Chrome 98.0.4758.102 / Windows 10",status:"成功"},{time:"2023-03-07 10:22:36",ip:"114.114.114.114",location:"中国 北京",device:"Safari / iOS 15.1",status:"成功"},{time:"2023-03-06 23:15:48",ip:"8.8.8.8",location:"美国 加利福尼亚",device:"Firefox 97.0 / macOS",status:"失败"},{time:"2023-03-05 14:30:22",ip:"192.168.1.1",location:"中国 广东 深圳",device:"Chrome 98.0.4758.102 / Windows 10",status:"成功"}]),L=s((()=>!!O.email)),P=e=>{switch(e){case"超级管理员":return"danger";case"管理员":return"warning";case"VIP用户":return"success";default:return"info"}},R=()=>{O.avatar="https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"},W=e=>{const a=new FileReader;a.readAsDataURL(e.raw),a.onload=()=>{O.avatar=a.result,v.success("头像上传成功")}},j=()=>{T.value=!0},E=async()=>{z.value&&await z.value.validate(((e,a)=>{e&&setTimeout((()=>{T.value=!1,v.success("个人信息保存成功");const e={username:O.username,role:O.role,avatar:O.avatar};localStorage.setItem("userInfo",JSON.stringify(e))}),500)}))},J=()=>{T.value=!1,z.value&&z.value.resetFields()},N=()=>{b.push("/user/reset-password")},D=()=>{v.info("功能开发中，敬请期待")},B=()=>{F.value=!0},G=e=>{if(!e)return"";const a=e.split("@");if(2!==a.length)return e;let l=a[0];const s=a[1];return l=l.length<=3?l.charAt(0)+"***":l.substring(0,3)+"***",l+"@"+s};return t((()=>{(()=>{const e=localStorage.getItem("userInfo");if(e){const a=JSON.parse(e);O.username=a.username||"admin",O.role=a.role||"超级管理员",O.avatar=a.avatar||"https://picsum.photos/200"}})()})),(e,a)=>{const l=o("el-button"),s=o("el-avatar"),t=o("el-upload"),v=o("el-input"),g=o("el-form-item"),b=o("el-tag"),H=o("el-form"),K=o("el-card"),M=o("el-divider"),Q=o("el-table-column"),X=o("el-table"),Y=o("el-dialog");return n(),r("div",h,[i(K,{class:"box-card"},{header:u((()=>[d("div",_,[a[7]||(a[7]=d("span",null,"个人信息",-1)),T.value?(n(),r("div",y,[i(l,{type:"success",size:"small",onClick:E},{default:u((()=>a[5]||(a[5]=[p("保存")]))),_:1}),i(l,{size:"small",onClick:J},{default:u((()=>a[6]||(a[6]=[p("取消")]))),_:1})])):(n(),c(l,{key:0,type:"primary",size:"small",onClick:j},{default:u((()=>a[4]||(a[4]=[p("编辑信息")]))),_:1}))])])),default:u((()=>[d("div",w,[d("div",k,[i(s,{size:120,src:O.avatar,onError:R},{default:u((()=>[p(f(O.username.charAt(0).toUpperCase()),1)])),_:1},8,["src"]),T.value?(n(),c(t,{key:0,class:"avatar-uploader",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":W},{default:u((()=>[i(l,{type:"primary",size:"small",class:"change-avatar-btn"},{default:u((()=>a[8]||(a[8]=[p("更换头像")]))),_:1})])),_:1})):m("",!0)]),d("div",V,[i(H,{model:O,rules:q,ref_key:"userFormRef",ref:z,"label-width":"100px",class:"user-form",disabled:!T.value},{default:u((()=>[i(g,{label:"用户名",prop:"username"},{default:u((()=>[i(v,{modelValue:O.username,"onUpdate:modelValue":a[0]||(a[0]=e=>O.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),i(g,{label:"昵称",prop:"nickname"},{default:u((()=>[i(v,{modelValue:O.nickname,"onUpdate:modelValue":a[1]||(a[1]=e=>O.nickname=e),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1}),i(g,{label:"邮箱",prop:"email"},{default:u((()=>[i(v,{modelValue:O.email,"onUpdate:modelValue":a[2]||(a[2]=e=>O.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),i(g,{label:"角色"},{default:u((()=>[i(b,{type:P(O.role)},{default:u((()=>[p(f(O.role),1)])),_:1},8,["type"])])),_:1}),i(g,{label:"注册时间"},{default:u((()=>[d("span",null,f(O.registerTime),1)])),_:1}),i(g,{label:"最后登录"},{default:u((()=>[d("span",null,f(O.lastLoginTime),1)])),_:1})])),_:1},8,["model","rules","disabled"])])])])),_:1}),i(K,{class:"box-card security-card"},{header:u((()=>a[9]||(a[9]=[d("div",{class:"card-header"},[d("span",null,"安全设置")],-1)]))),default:u((()=>[d("div",x,[d("div",C,[a[11]||(a[11]=d("div",{class:"security-info"},[d("h4",null,"账户密码"),d("p",null,"定期更改密码可以保护您的账户安全")],-1)),i(l,{type:"primary",plain:"",onClick:N},{default:u((()=>a[10]||(a[10]=[p("修改密码")]))),_:1})]),i(M),d("div",I,[d("div",S,[a[12]||(a[12]=d("h4",null,"绑定邮箱",-1)),d("p",null,"已绑定邮箱："+f(G(O.email)),1)]),i(l,{plain:"",onClick:D,disabled:!L.value},{default:u((()=>[p(f(L.value?"更换邮箱":"已绑定"),1)])),_:1},8,["disabled"])]),i(M),d("div",U,[a[14]||(a[14]=d("div",{class:"security-info"},[d("h4",null,"登录日志"),d("p",null,"查看您的账号登录记录")],-1)),i(l,{plain:"",onClick:B},{default:u((()=>a[13]||(a[13]=[p("查看记录")]))),_:1})])])])),_:1}),i(Y,{modelValue:F.value,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value=e),title:"登录日志",width:"700px"},{default:u((()=>[i(X,{data:A.value,style:{width:"100%"},border:"",stripe:""},{default:u((()=>[i(Q,{prop:"time",label:"登录时间",width:"180"}),i(Q,{prop:"ip",label:"IP地址",width:"150"}),i(Q,{prop:"location",label:"登录地点"}),i(Q,{prop:"device",label:"设备信息"}),i(Q,{prop:"status",label:"状态",width:"100"},{default:u((e=>[i(b,{type:"成功"===e.row.status?"success":"danger"},{default:u((()=>[p(f(e.row.status),1)])),_:2},1032,["type"])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-e174bd8c"]]);export{z as default};

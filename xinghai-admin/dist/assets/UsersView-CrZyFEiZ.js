import{d as e,a,r as l,n as s,j as n,c as t,e as r,w as d,f as o,o as i,b as u,G as c,F as p,C as m,h as v,H as g,k as b,t as h,l as f,E as V,s as w,_}from"./index-DdCtHfSO.js";const y={class:"users-container"},k={class:"card-header"},I={class:"search-area"},U={class:"balance"},x={class:"status-text"},C={class:"action-buttons"},T={class:"pagination-container"},$={class:"captcha-container"},B=["src"],R={key:0,class:"balance-tip"},L={class:"status-text"},P={class:"dialog-footer"},z=_(e({__name:"UsersView",setup(e){const _=a({userId:"",email:"",vipLevel:"",status:"",dateRange:[]}),z=l([{userId:"U10001",username:"user123",nickname:"张小明",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"138****1234",email:"user123@example.com",role:0,status:"正常",statusBool:!0,registerTime:"2024-01-15 10:00:00",lastLoginTime:"2024-03-15 08:30:00",registerIp:"192.168.1.1",balance:100.5,orders:5},{userId:"U10002",username:"admin456",nickname:"李管理",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"139****5678",email:"admin456@example.com",role:3,status:"正常",statusBool:!0,registerTime:"2023-12-20 14:30:00",lastLoginTime:"2024-03-15 09:15:00",registerIp:"192.168.1.2",balance:0,orders:0},{userId:"U10003",username:"vip789",nickname:"王大富",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"137****9012",email:"vip789@example.com",role:2,status:"正常",statusBool:!0,registerTime:"2024-02-05 16:45:00",lastLoginTime:"2024-03-14 18:20:00",registerIp:"192.168.1.3",balance:500.75,orders:12},{userId:"U10004",username:"test321",nickname:"赵测试",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"136****3456",email:"test321@example.com",role:0,status:"禁用",statusBool:!1,registerTime:"2024-01-30 09:10:00",lastLoginTime:"2024-02-28 11:05:00",registerIp:"192.168.1.4",balance:50.25,orders:2},{userId:"U10005",username:"guest555",nickname:"陈访客",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"135****7890",email:"guest555@example.com",role:1,status:"正常",statusBool:!0,registerTime:"2024-03-01 13:25:00",lastLoginTime:"2024-03-15 07:40:00",registerIp:"192.168.1.5",balance:0,orders:0}]),D=l([{id:1,name:"普通用户",level:0,condition:"默认等级",minRecharge:0,discount:100,description:"所有用户的默认等级"},{id:2,name:"VIP1",level:1,condition:"累计充值满100元",minRecharge:100,discount:95,description:"储值用户享受95折优惠"},{id:3,name:"VIP2",level:2,condition:"累计充值满1000元",minRecharge:1e3,discount:90,description:"稳定用户、活跃用户享受9折优惠"},{id:4,name:"VIP3",level:3,condition:"累计充值满5000元",minRecharge:5e3,discount:85,description:"大客户，可定期回访与商务交流"}]),q=l(1),j=l(10),Y=l(0),M=l(!1),S=e=>["","success","warning","danger"][e]||"",E=e=>{const a=D.value.find((a=>a.level===e));return a?a.name:"未知等级"},F=()=>{q.value=1,le()},H=()=>{_.userId="",_.email="",_.vipLevel="",_.status="",_.dateRange=[],q.value=1,le()},G=l(!1),N=l("add"),A=l(),J=l("https://cube.elemecdn.com/9/3f/2c0938b93c591b218c1beaf08de07jpeg.jpeg"),K=a({userId:"",username:"",nickname:"",password:"",confirmPassword:"",phone:"",email:"",captcha:"",role:0,balance:0,statusBool:!0}),O=a({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{max:20,message:"长度不能超过 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(e,a,l)=>{a!==K.password?l(new Error("两次输入密码不一致")):l()},trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:4,max:6,message:"验证码长度不正确",trigger:"blur"}],role:[{required:!0,message:"请选择会员等级",trigger:"change"}]}),Q=()=>{J.value=`https://cube.elemecdn.com/9/3f/2c0938b93c591b218c1beaf08de07jpeg.jpeg?t=${Date.now()}`,V.success("验证码已刷新")},W=()=>{N.value="add",K.userId="",K.username="",K.nickname="",K.password="",K.confirmPassword="",K.phone="",K.email="",K.captcha="",K.role=0,K.balance=0,K.statusBool=!0,G.value=!0,Q()},X=l(0),Z=e=>{const a=ee(e);X.value=a,K.role=a},ee=e=>{for(let a=D.value.length-1;a>=0;a--){const l=D.value[a];if(e>=l.minRecharge)return l.level}return 0},ae=async()=>{A.value&&await A.value.validate(((e,a)=>{e&&("add"===N.value?V.success("新增用户成功"):V.success("编辑用户成功"),G.value=!1)}))},le=()=>{M.value=!0,setTimeout((()=>{const e=z.value.filter((e=>{if(_.userId&&!e.userId.includes(_.userId))return!1;if(_.email&&!e.email.includes(_.email))return!1;if(""!==_.vipLevel&&e.role!==Number(_.vipLevel))return!1;if(_.status){if("normal"===_.status&&"正常"!==e.status)return!1;if("disabled"===_.status&&"禁用"!==e.status)return!1}if(_.dateRange&&2===_.dateRange.length){const a=new Date(_.dateRange[0]),l=new Date(_.dateRange[1]),s=new Date(e.registerTime);if(s<a||s>l)return!1}return!0}));Y.value=e.length;const a=(q.value-1)*j.value,l=a+j.value;z.value=e.slice(a,l),M.value=!1}),500)},se=e=>{j.value=e,le()},ne=e=>{q.value=e,le()};return s([()=>_.userId,()=>_.email,()=>_.vipLevel,()=>_.status,()=>_.dateRange],(()=>{q.value=1,le()})),n((()=>{le()})),(e,a)=>{const l=o("el-button"),s=o("el-input"),n=o("el-form-item"),le=o("el-option"),te=o("el-select"),re=o("el-date-picker"),de=o("el-form"),oe=o("el-table-column"),ie=o("el-tag"),ue=o("el-switch"),ce=o("el-table"),pe=o("el-pagination"),me=o("el-card"),ve=o("el-input-number"),ge=o("el-alert"),be=o("el-dialog"),he=g("loading");return i(),t("div",y,[r(me,{class:"box-card"},{header:d((()=>[u("div",k,[a[20]||(a[20]=u("span",null,"用户管理",-1)),r(l,{type:"primary",size:"small",onClick:W},{default:d((()=>a[19]||(a[19]=[v("新增用户")]))),_:1})])])),default:d((()=>[a[26]||(a[26]=u("div",{class:"page-description"},[u("p",null,"管理系统的所有用户账号，包括普通用户和各等级VIP会员。用户的会员等级会根据累计充值金额自动调整，您也可以手动设置用户的会员等级和账户余额。")],-1)),u("div",I,[r(de,{inline:!0,model:_,class:"demo-form-inline"},{default:d((()=>[r(n,{label:"用户ID"},{default:d((()=>[r(s,{modelValue:_.userId,"onUpdate:modelValue":a[0]||(a[0]=e=>_.userId=e),placeholder:"请输入用户ID",clearable:""},null,8,["modelValue"])])),_:1}),r(n,{label:"邮箱"},{default:d((()=>[r(s,{modelValue:_.email,"onUpdate:modelValue":a[1]||(a[1]=e=>_.email=e),placeholder:"请输入邮箱",clearable:""},null,8,["modelValue"])])),_:1}),r(n,{label:"会员等级"},{default:d((()=>[r(te,{modelValue:_.vipLevel,"onUpdate:modelValue":a[2]||(a[2]=e=>_.vipLevel=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:d((()=>[r(le,{label:"全部",value:""}),(i(!0),t(p,null,m(D.value,(e=>(i(),b(le,{key:e.level,label:e.name,value:e.level},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(n,{label:"用户状态"},{default:d((()=>[r(te,{modelValue:_.status,"onUpdate:modelValue":a[3]||(a[3]=e=>_.status=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:d((()=>[r(le,{label:"全部",value:""}),r(le,{label:"正常",value:"normal"}),r(le,{label:"禁用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),r(n,{label:"注册时间"},{default:d((()=>[r(re,{modelValue:_.dateRange,"onUpdate:modelValue":a[4]||(a[4]=e=>_.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),r(n,null,{default:d((()=>[r(l,{type:"primary",onClick:F},{default:d((()=>a[21]||(a[21]=[v("查询")]))),_:1}),r(l,{onClick:H},{default:d((()=>a[22]||(a[22]=[v("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),c((i(),b(ce,{data:z.value,style:{width:"100%"},border:"",stripe:""},{default:d((()=>[r(oe,{type:"selection",width:"55"}),r(oe,{prop:"userId",label:"用户ID",width:"100"}),r(oe,{prop:"email",label:"邮箱","min-width":"180"}),r(oe,{prop:"nickname",label:"用户昵称",width:"120"}),r(oe,{prop:"role",label:"会员等级",width:"120"},{default:d((e=>[r(ie,{type:S(e.row.role)},{default:d((()=>[v(h(E(e.row.role)),1)])),_:2},1032,["type"])])),_:1}),r(oe,{prop:"balance",label:"账户余额",width:"120"},{default:d((e=>[u("span",U,"¥"+h(e.row.balance),1)])),_:1}),r(oe,{prop:"orders",label:"订单数",width:"100"}),r(oe,{prop:"status",label:"状态",width:"100"},{default:d((e=>[r(ue,{modelValue:e.row.statusBool,"onUpdate:modelValue":a=>e.row.statusBool=a,"active-value":!0,"inactive-value":!1,onChange:a=>((e,a)=>{const l=e?"启用":"禁用";V.success(`用户"${a.username}"已${l}`),a.status=e?"正常":"禁用"})(a,e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"]),u("span",x,h(e.row.statusBool?"正常":"禁用"),1)])),_:1}),r(oe,{prop:"registerTime",label:"注册时间",width:"180"}),r(oe,{label:"操作",width:"200",fixed:"right"},{default:d((e=>[u("div",C,[r(l,{size:"small",onClick:a=>{return l=e.row,void w.alert(`<div class="user-detail">\n      <div class="user-header">\n        <div class="user-avatar">\n          <img src="${l.avatar}" alt="${l.username}" />\n        </div>\n        <div class="user-info">\n          <h3>${l.username}</h3>\n          <p><el-tag size="small" :type="getRoleType(row.role)">${l.role}</el-tag></p>\n        </div>\n      </div>\n      \n      <div class="detail-section">\n        <h4>基本信息</h4>\n        <div class="detail-item">\n          <span class="label">用户ID：</span>\n          <span>${l.userId}</span>\n        </div>\n        <div class="detail-item">\n          <span class="label">昵称：</span>\n          <span>${l.nickname||"未设置"}</span>\n        </div>\n        <div class="detail-item">\n          <span class="label">手机号：</span>\n          <span>${l.phone}</span>\n        </div>\n        <div class="detail-item">\n          <span class="label">邮箱：</span>\n          <span>${l.email}</span>\n        </div>\n        <div class="detail-item">\n          <span class="label">状态：</span>\n          <span>${l.status}</span>\n        </div>\n      </div>\n      \n      <div class="detail-section">\n        <h4>账户信息</h4>\n        <div class="detail-item">\n          <span class="label">账户余额：</span>\n          <span>¥${l.balance}</span>\n        </div>\n        <div class="detail-item">\n          <span class="label">订单数量：</span>\n          <span>${l.orders}</span>\n        </div>\n      </div>\n      \n      <div class="detail-section">\n        <h4>其他信息</h4>\n        <div class="detail-item">\n          <span class="label">注册时间：</span>\n          <span>${l.registerTime}</span>\n        </div>\n        <div class="detail-item">\n          <span class="label">注册IP：</span>\n          <span>${l.registerIp}</span>\n        </div>\n        <div class="detail-item">\n          <span class="label">最后登录：</span>\n          <span>${l.lastLoginTime}</span>\n        </div>\n      </div>\n    </div>`,"用户详情",{dangerouslyUseHTMLString:!0,confirmButtonText:"关闭",customClass:"user-detail-dialog"});var l}},{default:d((()=>a[23]||(a[23]=[v("查看")]))),_:2},1032,["onClick"]),r(l,{size:"small",type:"primary",onClick:a=>{return l=e.row,N.value="edit",K.userId=l.userId,K.username=l.username,K.nickname=l.nickname,K.phone=l.phone,K.email=l.email,K.role=l.role,K.balance=l.balance,K.statusBool=l.statusBool,X.value=ee(l.balance),void(G.value=!0);var l}},{default:d((()=>a[24]||(a[24]=[v("编辑")]))),_:2},1032,["onClick"]),r(l,{size:"small",type:"danger",onClick:a=>{return l=e.row,void w.confirm(`确定要删除用户"${l.username}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{V({type:"success",message:`用户"${l.username}"已删除`})})).catch((()=>{V({type:"info",message:"已取消删除"})}));var l}},{default:d((()=>a[25]||(a[25]=[v("删除")]))),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])),[[he,M.value]]),u("div",T,[r(pe,{"current-page":q.value,"onUpdate:currentPage":a[5]||(a[5]=e=>q.value=e),"page-size":j.value,"onUpdate:pageSize":a[6]||(a[6]=e=>j.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:Y.value,onSizeChange:se,onCurrentChange:ne,background:!0},null,8,["current-page","page-size","total"])])])),_:1}),r(be,{modelValue:G.value,"onUpdate:modelValue":a[18]||(a[18]=e=>G.value=e),title:"add"===N.value?"新增用户":"编辑用户",width:"650px"},{footer:d((()=>[u("span",P,[r(l,{onClick:a[17]||(a[17]=e=>G.value=!1)},{default:d((()=>a[28]||(a[28]=[v("取消")]))),_:1}),r(l,{type:"primary",onClick:ae},{default:d((()=>a[29]||(a[29]=[v("确定")]))),_:1})])])),default:d((()=>[r(de,{model:K,"label-width":"100px",rules:O,ref_key:"userFormRef",ref:A},{default:d((()=>[r(n,{label:"用户名",prop:"username"},{default:d((()=>[r(s,{modelValue:K.username,"onUpdate:modelValue":a[7]||(a[7]=e=>K.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),r(n,{label:"昵称",prop:"nickname"},{default:d((()=>[r(s,{modelValue:K.nickname,"onUpdate:modelValue":a[8]||(a[8]=e=>K.nickname=e),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1}),"add"===N.value?(i(),b(n,{key:0,label:"密码",prop:"password"},{default:d((()=>[r(s,{modelValue:K.password,"onUpdate:modelValue":a[9]||(a[9]=e=>K.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})):f("",!0),"add"===N.value?(i(),b(n,{key:1,label:"确认密码",prop:"confirmPassword"},{default:d((()=>[r(s,{modelValue:K.confirmPassword,"onUpdate:modelValue":a[10]||(a[10]=e=>K.confirmPassword=e),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])])),_:1})):f("",!0),r(n,{label:"手机号",prop:"phone"},{default:d((()=>[r(s,{modelValue:K.phone,"onUpdate:modelValue":a[11]||(a[11]=e=>K.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),r(n,{label:"邮箱",prop:"email"},{default:d((()=>[r(s,{modelValue:K.email,"onUpdate:modelValue":a[12]||(a[12]=e=>K.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),"add"===N.value?(i(),b(n,{key:2,label:"图形验证码",prop:"captcha"},{default:d((()=>[u("div",$,[r(s,{modelValue:K.captcha,"onUpdate:modelValue":a[13]||(a[13]=e=>K.captcha=e),placeholder:"请输入验证码"},null,8,["modelValue"]),u("div",{class:"captcha-image",onClick:Q},[u("img",{src:J.value,alt:"验证码"},null,8,B)])])])),_:1})):f("",!0),r(n,{label:"会员等级",prop:"role"},{default:d((()=>[r(te,{modelValue:K.role,"onUpdate:modelValue":a[14]||(a[14]=e=>K.role=e),placeholder:"请选择会员等级",style:{width:"168px"}},{default:d((()=>[(i(!0),t(p,null,m(D.value,(e=>(i(),b(le,{key:e.level,label:e.name,value:e.level},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(n,{label:"账户余额",prop:"balance"},{default:d((()=>[r(ve,{modelValue:K.balance,"onUpdate:modelValue":a[15]||(a[15]=e=>K.balance=e),min:0,precision:2,step:10,style:{width:"100%"},onChange:Z},null,8,["modelValue"]),K.balance>0?(i(),t("div",R,[r(ge,{title:"会员等级自动升级提示",type:"info",closable:!1,"show-icon":""},{default:d((()=>[a[27]||(a[27]=v(" 根据当前账户余额，用户会员等级将自动调整为 ")),r(ie,{type:S(X.value)},{default:d((()=>[v(h(E(X.value)),1)])),_:1},8,["type"])])),_:1})])):f("",!0)])),_:1}),r(n,{label:"状态"},{default:d((()=>[r(ue,{modelValue:K.statusBool,"onUpdate:modelValue":a[16]||(a[16]=e=>K.statusBool=e)},null,8,["modelValue"]),u("span",L,h(K.statusBool?"正常":"禁用"),1)])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-1924a08b"]]);export{z as default};

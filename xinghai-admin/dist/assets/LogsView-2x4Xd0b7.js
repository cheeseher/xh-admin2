import{d as e,a,r as l,n as t,j as s,c as o,e as r,w as i,f as u,o as d,b as n,G as p,F as c,C as m,h as v,H as g,k as b,t as y,l as f,E as h,s as T,_ as w}from"./index-DdCtHfSO.js";const _={class:"logs-container"},D={class:"card-header"},k={class:"search-area"},V={class:"action-buttons"},O={class:"pagination-container"},P={class:"log-detail"},S={class:"detail-section"},J={class:"detail-item"},x={class:"detail-item"},q={class:"detail-item"},C={class:"detail-item"},N={class:"detail-item"},z={class:"detail-item"},M={class:"detail-section"},I={class:"detail-item"},R={class:"detail-item"},U={class:"detail-item"},E={class:"detail-item"},j={key:0,class:"detail-section"},G={class:"code-block"},Y={key:1,class:"detail-section"},H={class:"code-block"},L={key:2,class:"detail-section"},B={class:"code-block error"},F={class:"dialog-footer"},X=w(e({__name:"LogsView",setup(e){const w=a({operator:"",operationType:"",module:"",status:"",dateRange:[]}),X=l([{value:"login",label:"登录"},{value:"logout",label:"登出"},{value:"query",label:"查询"},{value:"add",label:"新增"},{value:"update",label:"修改"},{value:"delete",label:"删除"},{value:"import",label:"导入"},{value:"export",label:"导出"},{value:"upload",label:"上传"},{value:"download",label:"下载"},{value:"other",label:"其他"}]),$=l([{value:"system",label:"系统管理"},{value:"user",label:"用户管理"},{value:"role",label:"角色管理"},{value:"account",label:"账户管理"},{value:"product",label:"商品管理"},{value:"order",label:"订单管理"},{value:"category",label:"分类管理"},{value:"member",label:"会员管理"},{value:"template",label:"模板管理"},{value:"setting",label:"系统设置"}]),A=e=>({login:"success",logout:"info",query:"info",add:"primary",update:"warning",delete:"danger",import:"success",export:"success",upload:"primary",download:"primary",other:"info"}[e]||"info"),K=e=>{const a=X.value.find((a=>a.value===e));return a?a.label:e},Q=l([{id:"1001",operator:"张三",operationType:"login",module:"系统管理",ip:"192.168.1.1",description:"用户登录系统",status:"成功",operationTime:"2024-03-15 08:30:00",method:"POST",url:"/api/login",requestParams:JSON.stringify({username:"admin",password:"******"}),responseData:JSON.stringify({code:200,message:"登录成功",data:{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}),errorMessage:""},{id:"1002",operator:"李四",operationType:"query",module:"用户管理",ip:"192.168.1.2",description:"查询用户列表",status:"成功",operationTime:"2024-03-15 09:15:00",method:"GET",url:"/api/users",requestParams:JSON.stringify({page:1,size:10}),responseData:JSON.stringify({code:200,message:"查询成功",data:{total:100,list:[]}}),errorMessage:""},{id:"1003",operator:"王五",operationType:"add",module:"商品管理",ip:"192.168.1.3",description:"新增商品",status:"成功",operationTime:"2024-03-15 10:20:00",method:"POST",url:"/api/products",requestParams:JSON.stringify({name:"测试商品",price:99.9,stock:100}),responseData:JSON.stringify({code:200,message:"新增成功",data:{id:1001}}),errorMessage:""},{id:"1004",operator:"赵六",operationType:"update",module:"订单管理",ip:"192.168.1.4",description:"修改订单状态",status:"成功",operationTime:"2024-03-15 11:30:00",method:"PUT",url:"/api/orders/10086",requestParams:JSON.stringify({status:"shipped"}),responseData:JSON.stringify({code:200,message:"修改成功"}),errorMessage:""},{id:"1005",operator:"张三",operationType:"delete",module:"分类管理",ip:"192.168.1.1",description:"删除商品分类",status:"失败",operationTime:"2024-03-15 13:45:00",method:"DELETE",url:"/api/categories/123",requestParams:"",responseData:"",errorMessage:"该分类下存在关联商品，无法删除"},{id:"1006",operator:"李四",operationType:"export",module:"订单管理",ip:"192.168.1.2",description:"导出订单数据",status:"成功",operationTime:"2024-03-15 14:50:00",method:"GET",url:"/api/orders/export",requestParams:JSON.stringify({startDate:"2024-03-01",endDate:"2024-03-15"}),responseData:"",errorMessage:""},{id:"1007",operator:"王五",operationType:"upload",module:"商品管理",ip:"192.168.1.3",description:"上传商品图片",status:"成功",operationTime:"2024-03-15 15:30:00",method:"POST",url:"/api/upload",requestParams:"FormData",responseData:JSON.stringify({code:200,message:"上传成功",data:{url:"/uploads/products/image001.jpg"}}),errorMessage:""},{id:"1008",operator:"赵六",operationType:"logout",module:"系统管理",ip:"192.168.1.4",description:"用户退出系统",status:"成功",operationTime:"2024-03-15 17:00:00",method:"POST",url:"/api/logout",requestParams:"",responseData:JSON.stringify({code:200,message:"退出成功"}),errorMessage:""}]),W=l(1),Z=l(10),ee=l(0),ae=l(!1),le=()=>{W.value=1,ue()},te=()=>{w.operator="",w.operationType="",w.module="",w.status="",w.dateRange=[],W.value=1,ue()},se=()=>{h.success("日志导出成功")},oe=a({id:"",operator:"",operationType:"",module:"",ip:"",description:"",status:"",operationTime:"",method:"",url:"",requestParams:"",responseData:"",errorMessage:""}),re=l(!1),ie=e=>{try{const a=JSON.parse(e);return JSON.stringify(a,null,2)}catch(a){return e}},ue=()=>{ae.value=!0,setTimeout((()=>{const e=Q.value.filter((e=>{if(w.operator&&!e.operator.includes(w.operator))return!1;if(w.operationType&&e.operationType!==w.operationType)return!1;if(w.module&&!e.module.includes(w.module))return!1;if(w.status){if("success"===w.status&&"成功"!==e.status)return!1;if("fail"===w.status&&"失败"!==e.status)return!1}if(w.dateRange&&2===w.dateRange.length){const a=new Date(w.dateRange[0]),l=new Date(w.dateRange[1]),t=new Date(e.operationTime);if(t<a||t>l)return!1}return!0}));ee.value=e.length;const a=(W.value-1)*Z.value,l=a+Z.value;Q.value=e.slice(a,l),ae.value=!1}),500)},de=e=>{Z.value=e,ue()},ne=e=>{W.value=e,ue()};return t([()=>w.operator,()=>w.operationType,()=>w.module,()=>w.status,()=>w.dateRange],(()=>{W.value=1,ue()})),s((()=>{ue()})),(e,a)=>{const l=u("el-button"),t=u("el-input"),s=u("el-form-item"),ue=u("el-option"),pe=u("el-select"),ce=u("el-date-picker"),me=u("el-form"),ve=u("el-table-column"),ge=u("el-tag"),be=u("el-table"),ye=u("el-pagination"),fe=u("el-card"),he=u("el-dialog"),Te=g("loading");return d(),o("div",_,[r(fe,{class:"box-card"},{header:i((()=>[n("div",D,[a[10]||(a[10]=n("span",null,"操作日志",-1)),r(l,{type:"primary",size:"small",onClick:se},{default:i((()=>a[9]||(a[9]=[v("导出日志")]))),_:1})])])),default:i((()=>[a[15]||(a[15]=n("div",{class:"page-description"},[n("p",null,"记录系统中的所有操作行为，包括登录、新增、修改、删除等操作，方便追踪用户行为和系统安全审计。")],-1)),n("div",k,[r(me,{inline:!0,model:w,class:"demo-form-inline"},{default:i((()=>[r(s,{label:"操作人"},{default:i((()=>[r(t,{modelValue:w.operator,"onUpdate:modelValue":a[0]||(a[0]=e=>w.operator=e),placeholder:"请输入操作人",clearable:""},null,8,["modelValue"])])),_:1}),r(s,{label:"操作类型"},{default:i((()=>[r(pe,{modelValue:w.operationType,"onUpdate:modelValue":a[1]||(a[1]=e=>w.operationType=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:i((()=>[r(ue,{label:"全部",value:""}),(d(!0),o(c,null,m(X.value,(e=>(d(),b(ue,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"操作模块"},{default:i((()=>[r(pe,{modelValue:w.module,"onUpdate:modelValue":a[2]||(a[2]=e=>w.module=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:i((()=>[r(ue,{label:"全部",value:""}),(d(!0),o(c,null,m($.value,(e=>(d(),b(ue,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"操作状态"},{default:i((()=>[r(pe,{modelValue:w.status,"onUpdate:modelValue":a[3]||(a[3]=e=>w.status=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:i((()=>[r(ue,{label:"全部",value:""}),r(ue,{label:"成功",value:"success"}),r(ue,{label:"失败",value:"fail"})])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"操作时间"},{default:i((()=>[r(ce,{modelValue:w.dateRange,"onUpdate:modelValue":a[4]||(a[4]=e=>w.dateRange=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD HH:mm:ss","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])])),_:1}),r(s,null,{default:i((()=>[r(l,{type:"primary",onClick:le},{default:i((()=>a[11]||(a[11]=[v("查询")]))),_:1}),r(l,{onClick:te},{default:i((()=>a[12]||(a[12]=[v("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),p((d(),b(be,{data:Q.value,style:{width:"100%"},border:"",stripe:""},{default:i((()=>[r(ve,{type:"selection",width:"55"}),r(ve,{prop:"id",label:"日志ID",width:"80"}),r(ve,{prop:"operator",label:"操作人",width:"120"}),r(ve,{prop:"operationType",label:"操作类型",width:"100"},{default:i((e=>[r(ge,{type:A(e.row.operationType)},{default:i((()=>[v(y(K(e.row.operationType)),1)])),_:2},1032,["type"])])),_:1}),r(ve,{prop:"module",label:"操作模块",width:"120"}),r(ve,{prop:"ip",label:"IP地址",width:"120"}),r(ve,{prop:"description",label:"操作描述","min-width":"250"}),r(ve,{prop:"status",label:"状态",width:"80"},{default:i((e=>[r(ge,{type:"成功"===e.row.status?"success":"danger"},{default:i((()=>[v(y(e.row.status),1)])),_:2},1032,["type"])])),_:1}),r(ve,{prop:"operationTime",label:"操作时间",width:"180"}),r(ve,{label:"操作",width:"120",fixed:"right"},{default:i((e=>[n("div",V,[r(l,{size:"small",onClick:a=>{return l=e.row,Object.assign(oe,l),void(re.value=!0);var l}},{default:i((()=>a[13]||(a[13]=[v("详情")]))),_:2},1032,["onClick"]),r(l,{size:"small",type:"danger",onClick:a=>{return l=e.row,void T.confirm(`确定要删除ID为"${l.id}"的日志记录吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{h({type:"success",message:"日志记录已删除"})})).catch((()=>{h({type:"info",message:"已取消删除"})}));var l}},{default:i((()=>a[14]||(a[14]=[v("删除")]))),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])),[[Te,ae.value]]),n("div",O,[r(ye,{"current-page":W.value,"onUpdate:currentPage":a[5]||(a[5]=e=>W.value=e),"page-size":Z.value,"onUpdate:pageSize":a[6]||(a[6]=e=>Z.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:ee.value,onSizeChange:de,onCurrentChange:ne,background:!0},null,8,["current-page","page-size","total"])])])),_:1}),r(he,{modelValue:re.value,"onUpdate:modelValue":a[8]||(a[8]=e=>re.value=e),title:"日志详情",width:"700px"},{footer:i((()=>[n("span",F,[r(l,{onClick:a[7]||(a[7]=e=>re.value=!1)},{default:i((()=>a[31]||(a[31]=[v("关闭")]))),_:1})])])),default:i((()=>[n("div",P,[n("div",S,[a[22]||(a[22]=n("h4",null,"基本信息",-1)),n("div",J,[a[16]||(a[16]=n("span",{class:"label"},"日志ID：",-1)),n("span",null,y(oe.id),1)]),n("div",x,[a[17]||(a[17]=n("span",{class:"label"},"操作人：",-1)),n("span",null,y(oe.operator),1)]),n("div",q,[a[18]||(a[18]=n("span",{class:"label"},"操作类型：",-1)),n("span",null,[r(ge,{size:"small",type:A(oe.operationType)},{default:i((()=>[v(y(K(oe.operationType)),1)])),_:1},8,["type"])])]),n("div",C,[a[19]||(a[19]=n("span",{class:"label"},"操作模块：",-1)),n("span",null,y(oe.module),1)]),n("div",N,[a[20]||(a[20]=n("span",{class:"label"},"操作状态：",-1)),n("span",null,[r(ge,{size:"small",type:"成功"===oe.status?"success":"danger"},{default:i((()=>[v(y(oe.status),1)])),_:1},8,["type"])])]),n("div",z,[a[21]||(a[21]=n("span",{class:"label"},"操作时间：",-1)),n("span",null,y(oe.operationTime),1)])]),n("div",M,[a[27]||(a[27]=n("h4",null,"操作详情",-1)),n("div",I,[a[23]||(a[23]=n("span",{class:"label"},"IP地址：",-1)),n("span",null,y(oe.ip),1)]),n("div",R,[a[24]||(a[24]=n("span",{class:"label"},"操作描述：",-1)),n("span",null,y(oe.description),1)]),n("div",U,[a[25]||(a[25]=n("span",{class:"label"},"请求方法：",-1)),n("span",null,y(oe.method),1)]),n("div",E,[a[26]||(a[26]=n("span",{class:"label"},"请求URL：",-1)),n("span",null,y(oe.url),1)])]),oe.requestParams?(d(),o("div",j,[a[28]||(a[28]=n("h4",null,"请求参数",-1)),n("div",G,[n("pre",null,y(ie(oe.requestParams)),1)])])):f("",!0),oe.responseData?(d(),o("div",Y,[a[29]||(a[29]=n("h4",null,"响应数据",-1)),n("div",H,[n("pre",null,y(ie(oe.responseData)),1)])])):f("",!0),oe.errorMessage?(d(),o("div",L,[a[30]||(a[30]=n("h4",null,"错误信息",-1)),n("div",B,[n("pre",null,y(oe.errorMessage),1)])])):f("",!0)])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-887b53e2"]]);export{X as default};

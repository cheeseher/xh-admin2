import{d as e,a,r as l,n as t,j as s,c as o,e as r,w as i,f as u,o as d,b as p,H as n,F as c,D as m,h as v,J as g,k as b,t as y,l as f,E as h,_ as T}from"./index-Lit_3WrB.js";const _={class:"logs-container"},w={class:"card-header"},D={class:"search-area"},k={class:"action-buttons"},V={class:"pagination-container"},O={class:"log-detail"},P={class:"detail-section"},S={class:"detail-item"},J={class:"detail-item"},q={class:"detail-item"},N={class:"detail-item"},x={class:"detail-item"},M={class:"detail-item"},z={class:"detail-section"},C={class:"detail-item"},I={class:"detail-item"},R={class:"detail-item"},U={class:"detail-item"},E={key:0,class:"detail-section"},j={class:"code-block"},Y={key:1,class:"detail-section"},G={class:"code-block"},H={key:2,class:"detail-section"},L={class:"code-block error"},F={class:"dialog-footer"},X=T(e({__name:"LogsView",setup(e){const T=a({operator:"",operationType:"",module:"",status:"",dateRange:[]}),X=l([{value:"login",label:"登录"},{value:"logout",label:"登出"},{value:"query",label:"查询"},{value:"add",label:"新增"},{value:"update",label:"修改"},{value:"delete",label:"删除"},{value:"import",label:"导入"},{value:"export",label:"导出"},{value:"upload",label:"上传"},{value:"download",label:"下载"},{value:"other",label:"其他"}]),A=l([{value:"system",label:"系统管理"},{value:"user",label:"用户管理"},{value:"role",label:"角色管理"},{value:"account",label:"账户管理"},{value:"product",label:"商品管理"},{value:"order",label:"订单管理"},{value:"category",label:"分类管理"},{value:"member",label:"会员管理"},{value:"template",label:"模板管理"},{value:"setting",label:"系统设置"}]),B=e=>({login:"success",logout:"info",query:"info",add:"primary",update:"warning",delete:"danger",import:"success",export:"success",upload:"primary",download:"primary",other:"info"}[e]||"info"),K=e=>{const a=X.value.find((a=>a.value===e));return a?a.label:e},Q=l([{id:"1001",operator:"张三",operationType:"login",module:"系统管理",ip:"192.168.1.1",description:"用户登录系统",status:"成功",operationTime:"2024-03-15 08:30:00",method:"POST",url:"/api/login",requestParams:JSON.stringify({username:"admin",password:"******"}),responseData:JSON.stringify({code:200,message:"登录成功",data:{token:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."}}),errorMessage:""},{id:"1002",operator:"李四",operationType:"query",module:"用户管理",ip:"192.168.1.2",description:"查询用户列表",status:"成功",operationTime:"2024-03-15 09:15:00",method:"GET",url:"/api/users",requestParams:JSON.stringify({page:1,size:10}),responseData:JSON.stringify({code:200,message:"查询成功",data:{total:100,list:[]}}),errorMessage:""},{id:"1003",operator:"王五",operationType:"add",module:"商品管理",ip:"192.168.1.3",description:"新增商品",status:"成功",operationTime:"2024-03-15 10:20:00",method:"POST",url:"/api/products",requestParams:JSON.stringify({name:"测试商品",price:99.9,stock:100}),responseData:JSON.stringify({code:200,message:"新增成功",data:{id:1001}}),errorMessage:""},{id:"1004",operator:"赵六",operationType:"update",module:"订单管理",ip:"192.168.1.4",description:"修改订单状态",status:"成功",operationTime:"2024-03-15 11:30:00",method:"PUT",url:"/api/orders/10086",requestParams:JSON.stringify({status:"shipped"}),responseData:JSON.stringify({code:200,message:"修改成功"}),errorMessage:""},{id:"1005",operator:"张三",operationType:"delete",module:"分类管理",ip:"192.168.1.1",description:"删除商品分类",status:"失败",operationTime:"2024-03-15 13:45:00",method:"DELETE",url:"/api/categories/123",requestParams:"",responseData:"",errorMessage:"该分类下存在关联商品，无法删除"},{id:"1006",operator:"李四",operationType:"export",module:"订单管理",ip:"192.168.1.2",description:"导出订单数据",status:"成功",operationTime:"2024-03-15 14:50:00",method:"GET",url:"/api/orders/export",requestParams:JSON.stringify({startDate:"2024-03-01",endDate:"2024-03-15"}),responseData:"",errorMessage:""},{id:"1007",operator:"王五",operationType:"upload",module:"商品管理",ip:"192.168.1.3",description:"上传商品图片",status:"成功",operationTime:"2024-03-15 15:30:00",method:"POST",url:"/api/upload",requestParams:"FormData",responseData:JSON.stringify({code:200,message:"上传成功",data:{url:"/uploads/products/image001.jpg"}}),errorMessage:""},{id:"1008",operator:"赵六",operationType:"logout",module:"系统管理",ip:"192.168.1.4",description:"用户退出系统",status:"成功",operationTime:"2024-03-15 17:00:00",method:"POST",url:"/api/logout",requestParams:"",responseData:JSON.stringify({code:200,message:"退出成功"}),errorMessage:""}]),W=l(1),Z=l(10),$=l(0),ee=l(!1),ae=()=>{W.value=1,ie()},le=()=>{T.operator="",T.operationType="",T.module="",T.status="",T.dateRange=[],W.value=1,ie()},te=()=>{h.success("日志导出成功")},se=a({id:"",operator:"",operationType:"",module:"",ip:"",description:"",status:"",operationTime:"",method:"",url:"",requestParams:"",responseData:"",errorMessage:""}),oe=l(!1),re=e=>{try{const a=JSON.parse(e);return JSON.stringify(a,null,2)}catch(a){return e}},ie=()=>{ee.value=!0,setTimeout((()=>{const e=Q.value.filter((e=>{if(T.operator&&!e.operator.includes(T.operator))return!1;if(T.operationType&&e.operationType!==T.operationType)return!1;if(T.module&&!e.module.includes(T.module))return!1;if(T.status){if("success"===T.status&&"成功"!==e.status)return!1;if("fail"===T.status&&"失败"!==e.status)return!1}if(T.dateRange&&2===T.dateRange.length){const a=new Date(T.dateRange[0]),l=new Date(T.dateRange[1]),t=new Date(e.operationTime);if(t<a||t>l)return!1}return!0}));$.value=e.length;const a=(W.value-1)*Z.value,l=a+Z.value;Q.value=e.slice(a,l),ee.value=!1}),500)},ue=e=>{Z.value=e,ie()},de=e=>{W.value=e,ie()};return t([()=>T.operator,()=>T.operationType,()=>T.module,()=>T.status,()=>T.dateRange],(()=>{W.value=1,ie()})),s((()=>{ie()})),(e,a)=>{const l=u("el-button"),t=u("el-input"),s=u("el-form-item"),h=u("el-option"),ie=u("el-select"),pe=u("el-date-picker"),ne=u("el-form"),ce=u("el-table-column"),me=u("el-tag"),ve=u("el-table"),ge=u("el-pagination"),be=u("el-card"),ye=u("el-dialog"),fe=g("loading");return d(),o("div",_,[r(be,{class:"box-card"},{header:i((()=>[p("div",w,[a[10]||(a[10]=p("span",null,"操作日志",-1)),r(l,{type:"primary",size:"small",onClick:te},{default:i((()=>a[9]||(a[9]=[v("导出日志")]))),_:1})])])),default:i((()=>[a[14]||(a[14]=p("div",{class:"page-description"},[p("p",null,"记录系统中的所有操作行为，包括登录、新增、修改、删除等操作，方便追踪用户行为和系统安全审计。")],-1)),p("div",D,[r(ne,{inline:!0,model:T,class:"demo-form-inline"},{default:i((()=>[r(s,{label:"操作人"},{default:i((()=>[r(t,{modelValue:T.operator,"onUpdate:modelValue":a[0]||(a[0]=e=>T.operator=e),placeholder:"请输入操作人",clearable:""},null,8,["modelValue"])])),_:1}),r(s,{label:"操作类型"},{default:i((()=>[r(ie,{modelValue:T.operationType,"onUpdate:modelValue":a[1]||(a[1]=e=>T.operationType=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:i((()=>[r(h,{label:"全部",value:""}),(d(!0),o(c,null,m(X.value,(e=>(d(),b(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"操作模块"},{default:i((()=>[r(ie,{modelValue:T.module,"onUpdate:modelValue":a[2]||(a[2]=e=>T.module=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:i((()=>[r(h,{label:"全部",value:""}),(d(!0),o(c,null,m(A.value,(e=>(d(),b(h,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"操作状态"},{default:i((()=>[r(ie,{modelValue:T.status,"onUpdate:modelValue":a[3]||(a[3]=e=>T.status=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:i((()=>[r(h,{label:"全部",value:""}),r(h,{label:"成功",value:"success"}),r(h,{label:"失败",value:"fail"})])),_:1},8,["modelValue"])])),_:1}),r(s,{label:"操作时间"},{default:i((()=>[r(pe,{modelValue:T.dateRange,"onUpdate:modelValue":a[4]||(a[4]=e=>T.dateRange=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD HH:mm:ss","default-time":["00:00:00","23:59:59"]},null,8,["modelValue"])])),_:1}),r(s,null,{default:i((()=>[r(l,{type:"primary",onClick:ae},{default:i((()=>a[11]||(a[11]=[v("查询")]))),_:1}),r(l,{onClick:le},{default:i((()=>a[12]||(a[12]=[v("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),n((d(),b(ve,{data:Q.value,style:{width:"100%"},border:"",stripe:""},{default:i((()=>[r(ce,{prop:"id",label:"日志ID",width:"80"}),r(ce,{prop:"operator",label:"操作人",width:"120"}),r(ce,{prop:"operationType",label:"操作类型",width:"100"},{default:i((e=>[r(me,{type:B(e.row.operationType)},{default:i((()=>[v(y(K(e.row.operationType)),1)])),_:2},1032,["type"])])),_:1}),r(ce,{prop:"module",label:"操作模块",width:"120"}),r(ce,{prop:"ip",label:"IP地址",width:"120"}),r(ce,{prop:"description",label:"操作描述","min-width":"250"}),r(ce,{prop:"status",label:"状态",width:"80"},{default:i((e=>[r(me,{type:"成功"===e.row.status?"success":"danger"},{default:i((()=>[v(y(e.row.status),1)])),_:2},1032,["type"])])),_:1}),r(ce,{prop:"operationTime",label:"操作时间",width:"180"}),r(ce,{label:"操作",width:"100",fixed:"right"},{default:i((e=>[p("div",k,[r(l,{size:"small",type:"primary",onClick:a=>{return l=e.row,Object.assign(se,l),void(oe.value=!0);var l}},{default:i((()=>a[13]||(a[13]=[v("详情")]))),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])),[[fe,ee.value]]),p("div",V,[r(ge,{"current-page":W.value,"onUpdate:currentPage":a[5]||(a[5]=e=>W.value=e),"page-size":Z.value,"onUpdate:pageSize":a[6]||(a[6]=e=>Z.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:$.value,onSizeChange:ue,onCurrentChange:de,background:!0},null,8,["current-page","page-size","total"])])])),_:1}),r(ye,{modelValue:oe.value,"onUpdate:modelValue":a[8]||(a[8]=e=>oe.value=e),title:"日志详情",width:"700px"},{footer:i((()=>[p("span",F,[r(l,{onClick:a[7]||(a[7]=e=>oe.value=!1)},{default:i((()=>a[30]||(a[30]=[v("关闭")]))),_:1})])])),default:i((()=>[p("div",O,[p("div",P,[a[21]||(a[21]=p("h4",null,"基本信息",-1)),p("div",S,[a[15]||(a[15]=p("span",{class:"label"},"日志ID：",-1)),p("span",null,y(se.id),1)]),p("div",J,[a[16]||(a[16]=p("span",{class:"label"},"操作人：",-1)),p("span",null,y(se.operator),1)]),p("div",q,[a[17]||(a[17]=p("span",{class:"label"},"操作类型：",-1)),p("span",null,[r(me,{size:"small",type:B(se.operationType)},{default:i((()=>[v(y(K(se.operationType)),1)])),_:1},8,["type"])])]),p("div",N,[a[18]||(a[18]=p("span",{class:"label"},"操作模块：",-1)),p("span",null,y(se.module),1)]),p("div",x,[a[19]||(a[19]=p("span",{class:"label"},"操作状态：",-1)),p("span",null,[r(me,{size:"small",type:"成功"===se.status?"success":"danger"},{default:i((()=>[v(y(se.status),1)])),_:1},8,["type"])])]),p("div",M,[a[20]||(a[20]=p("span",{class:"label"},"操作时间：",-1)),p("span",null,y(se.operationTime),1)])]),p("div",z,[a[26]||(a[26]=p("h4",null,"操作详情",-1)),p("div",C,[a[22]||(a[22]=p("span",{class:"label"},"IP地址：",-1)),p("span",null,y(se.ip),1)]),p("div",I,[a[23]||(a[23]=p("span",{class:"label"},"操作描述：",-1)),p("span",null,y(se.description),1)]),p("div",R,[a[24]||(a[24]=p("span",{class:"label"},"请求方法：",-1)),p("span",null,y(se.method),1)]),p("div",U,[a[25]||(a[25]=p("span",{class:"label"},"请求URL：",-1)),p("span",null,y(se.url),1)])]),se.requestParams?(d(),o("div",E,[a[27]||(a[27]=p("h4",null,"请求参数",-1)),p("div",j,[p("pre",null,y(re(se.requestParams)),1)])])):f("",!0),se.responseData?(d(),o("div",Y,[a[28]||(a[28]=p("h4",null,"响应数据",-1)),p("div",G,[p("pre",null,y(re(se.responseData)),1)])])):f("",!0),se.errorMessage?(d(),o("div",H,[a[29]||(a[29]=p("h4",null,"错误信息",-1)),p("div",L,[p("pre",null,y(se.errorMessage),1)])])):f("",!0)])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-205818b2"]]);export{X as default};

import{d as e,r as a,a as l,i as s,j as t,c as i,e as r,w as u,f as o,o as d,b as n,k as c,l as m,h as p,t as v,E as f,u as h,_ as g}from"./index-Lit_3WrB.js";const b={class:"profile-container"},_={class:"card-header"},y={key:1},w={class:"profile-content"},k={class:"avatar-container"},C={class:"info-container"},V={class:"security-list"},x={class:"security-item"},S={class:"security-item"},I={class:"security-info"},z={class:"security-item"},T=g(e({__name:"ProfileView",setup(e){const g=h(),T=a(),U=a(!1),F=a(!1),O=l({username:"admin",email:"admin@xinghai.com",role:"超级管理员",avatar:"https://picsum.photos/200",registerTime:"2023-01-01 10:00:00",lastLoginTime:"2023-03-09 08:30:00"}),A=l({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]}),L=a([{time:"2023-03-09 08:30:00",ip:"192.168.1.1",location:"中国 广东 深圳",device:"Chrome 98.0.4758.102 / Windows 10",status:"成功"},{time:"2023-03-08 18:45:12",ip:"192.168.1.1",location:"中国 广东 深圳",device:"Chrome 98.0.4758.102 / Windows 10",status:"成功"},{time:"2023-03-07 10:22:36",ip:"114.114.114.114",location:"中国 北京",device:"Safari / iOS 15.1",status:"成功"},{time:"2023-03-06 23:15:48",ip:"8.8.8.8",location:"美国 加利福尼亚",device:"Firefox 97.0 / macOS",status:"失败"},{time:"2023-03-05 14:30:22",ip:"192.168.1.1",location:"中国 广东 深圳",device:"Chrome 98.0.4758.102 / Windows 10",status:"成功"}]),R=s((()=>!!O.email)),W=()=>{O.avatar="https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"},j=e=>{const a=new FileReader;a.readAsDataURL(e.raw),a.onload=()=>{O.avatar=a.result,f.success("头像上传成功")}},q=()=>{U.value=!0},E=async()=>{T.value&&await T.value.validate(((e,a)=>{e&&setTimeout((()=>{U.value=!1,f.success("个人信息保存成功");const e={username:O.username,role:O.role,avatar:O.avatar};localStorage.setItem("userInfo",JSON.stringify(e))}),500)}))},J=()=>{U.value=!1,T.value&&T.value.resetFields()},N=()=>{g.push("/user/reset-password")},P=()=>{f.info("功能开发中，敬请期待")},D=()=>{F.value=!0},B=e=>{if(!e)return"";const a=e.split("@");if(2!==a.length)return e;let l=a[0];const s=a[1];return l=l.length<=3?l.charAt(0)+"***":l.substring(0,3)+"***",l+"@"+s};return t((()=>{(()=>{const e=localStorage.getItem("userInfo");if(e){const a=JSON.parse(e);O.username=a.username||"admin",O.role=a.role||"超级管理员",O.avatar=a.avatar||"https://picsum.photos/200"}})()})),(e,a)=>{const l=o("el-button"),s=o("el-avatar"),t=o("el-upload"),f=o("el-input"),h=o("el-form-item"),g=o("el-tag"),G=o("el-form"),H=o("el-card"),K=o("el-divider"),M=o("el-table-column"),Q=o("el-table"),X=o("el-dialog");return d(),i("div",b,[r(H,{class:"box-card"},{header:u((()=>[n("div",_,[a[6]||(a[6]=n("span",null,"个人信息",-1)),U.value?(d(),i("div",y,[r(l,{type:"success",size:"small",onClick:E},{default:u((()=>a[4]||(a[4]=[p("保存")]))),_:1}),r(l,{size:"small",onClick:J},{default:u((()=>a[5]||(a[5]=[p("取消")]))),_:1})])):(d(),c(l,{key:0,type:"primary",size:"small",onClick:q},{default:u((()=>a[3]||(a[3]=[p("编辑信息")]))),_:1}))])])),default:u((()=>[n("div",w,[n("div",k,[r(s,{size:120,src:O.avatar,onError:W},{default:u((()=>[p(v(O.username.charAt(0).toUpperCase()),1)])),_:1},8,["src"]),U.value?(d(),c(t,{key:0,class:"avatar-uploader",action:"#","auto-upload":!1,"show-file-list":!1,"on-change":j},{default:u((()=>[r(l,{type:"primary",size:"small",class:"change-avatar-btn"},{default:u((()=>a[7]||(a[7]=[p("更换头像")]))),_:1})])),_:1})):m("",!0)]),n("div",C,[r(G,{model:O,rules:A,ref_key:"userFormRef",ref:T,"label-width":"100px",class:"user-form",disabled:!U.value},{default:u((()=>[r(h,{label:"用户名",prop:"username"},{default:u((()=>[r(f,{modelValue:O.username,"onUpdate:modelValue":a[0]||(a[0]=e=>O.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),r(h,{label:"邮箱",prop:"email"},{default:u((()=>[r(f,{modelValue:O.email,"onUpdate:modelValue":a[1]||(a[1]=e=>O.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),r(h,{label:"角色"},{default:u((()=>[r(g,{type:"danger"},{default:u((()=>a[8]||(a[8]=[p("超级管理员")]))),_:1})])),_:1}),r(h,{label:"注册时间"},{default:u((()=>[n("span",null,v(O.registerTime),1)])),_:1}),r(h,{label:"最后登录"},{default:u((()=>[n("span",null,v(O.lastLoginTime),1)])),_:1})])),_:1},8,["model","rules","disabled"])])])])),_:1}),r(H,{class:"box-card security-card"},{header:u((()=>a[9]||(a[9]=[n("div",{class:"card-header"},[n("span",null,"安全设置")],-1)]))),default:u((()=>[n("div",V,[n("div",x,[a[11]||(a[11]=n("div",{class:"security-info"},[n("h4",null,"账户密码"),n("p",null,"定期更改密码可以保护您的账户安全")],-1)),r(l,{type:"primary",plain:"",onClick:N},{default:u((()=>a[10]||(a[10]=[p("修改密码")]))),_:1})]),r(K),n("div",S,[n("div",I,[a[12]||(a[12]=n("h4",null,"绑定邮箱",-1)),n("p",null,"已绑定邮箱："+v(B(O.email)),1)]),r(l,{plain:"",onClick:P,disabled:!R.value},{default:u((()=>[p(v(R.value?"更换邮箱":"已绑定"),1)])),_:1},8,["disabled"])]),r(K),n("div",z,[a[14]||(a[14]=n("div",{class:"security-info"},[n("h4",null,"登录日志"),n("p",null,"查看您的账号登录记录")],-1)),r(l,{plain:"",onClick:D},{default:u((()=>a[13]||(a[13]=[p("查看记录")]))),_:1})])])])),_:1}),r(X,{modelValue:F.value,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value=e),title:"登录日志",width:"700px"},{default:u((()=>[r(Q,{data:L.value,style:{width:"100%"},border:"",stripe:""},{default:u((()=>[r(M,{prop:"time",label:"登录时间",width:"180"}),r(M,{prop:"ip",label:"IP地址",width:"150"}),r(M,{prop:"location",label:"登录地点"}),r(M,{prop:"device",label:"设备信息"}),r(M,{prop:"status",label:"状态",width:"100"},{default:u((e=>[r(g,{type:"成功"===e.row.status?"success":"danger"},{default:u((()=>[p(v(e.row.status),1)])),_:2},1032,["type"])])),_:1})])),_:1},8,["data"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-085aa96e"]]);export{T as default};

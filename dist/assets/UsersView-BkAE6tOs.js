import{d as e,a,r as l,i as t,n as s,j as r,c as n,e as o,w as u,f as d,o as i,b as c,H as m,F as p,D as g,h as v,J as b,k as f,t as h,l as V,E as w,s as I,_}from"./index-Lit_3WrB.js";const y={class:"users-container"},k={class:"card-header"},x={class:"search-area"},U={class:"balance"},P={class:"money"},R={class:"money"},B={class:"status-text"},C={class:"action-buttons"},D={class:"pagination-container"},T={class:"status-text"},L={class:"form-tip"},S={key:0,class:"info-text"},z={key:1,class:"warning-text"},j={class:"status-text"},q={class:"dialog-footer"},$=_(e({__name:"UsersView",setup(e){const _=a({userId:"",email:"",vipLevel:"",status:"",dateRange:[]}),$=l([{userId:"U10001",username:"user123",nickname:"张小明",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"138****1234",email:"user123@example.com",role:0,status:"正常",statusBool:!0,registerTime:"2024-01-15 10:00:00",lastLoginTime:"2024-03-15 08:30:00",registerIp:"192.168.1.1",balance:100.5,totalRecharge:1e3,totalSpent:899.5},{userId:"U10002",username:"admin456",nickname:"李管理",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"139****5678",email:"admin456@example.com",role:3,status:"正常",statusBool:!0,registerTime:"2023-12-20 14:30:00",lastLoginTime:"2024-03-15 09:15:00",registerIp:"192.168.1.2",balance:0,totalRecharge:0,totalSpent:0},{userId:"U10003",username:"vip789",nickname:"王大富",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"137****9012",email:"vip789@example.com",role:2,status:"正常",statusBool:!0,registerTime:"2024-02-05 16:45:00",lastLoginTime:"2024-03-14 18:20:00",registerIp:"192.168.1.3",balance:500.75,totalRecharge:5e3,totalSpent:4499.25},{userId:"U10004",username:"test321",nickname:"赵测试",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"136****3456",email:"test321@example.com",role:0,status:"禁用",statusBool:!1,registerTime:"2024-01-30 09:10:00",lastLoginTime:"2024-02-28 11:05:00",registerIp:"192.168.1.4",balance:50.25,totalRecharge:200,totalSpent:149.75},{userId:"U10005",username:"guest555",nickname:"陈访客",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"135****7890",email:"guest555@example.com",role:1,status:"正常",statusBool:!0,registerTime:"2024-03-01 13:25:00",lastLoginTime:"2024-03-15 07:40:00",registerIp:"192.168.1.5",balance:0,totalRecharge:0,totalSpent:0},{userId:"U10006",username:"supervip",nickname:"刘总",avatar:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png",phone:"133****6666",email:"supervip@example.com",role:4,status:"正常",statusBool:!0,registerTime:"2024-03-10 09:30:00",lastLoginTime:"2024-03-16 10:20:00",registerIp:"192.168.1.6",balance:1e4,totalRecharge:5e4,totalSpent:4e4}]),Y=l([{id:1,name:"普通用户",level:0,condition:"默认等级",minRecharge:0,discount:100,description:"所有用户的默认等级"},{id:2,name:"VIP1",level:1,condition:"累计充值满100元",minRecharge:100,discount:95,description:"储值用户享受95折优惠"},{id:3,name:"VIP2",level:2,condition:"累计充值满1000元",minRecharge:1e3,discount:90,description:"稳定用户、活跃用户享受9折优惠"},{id:4,name:"VIP3",level:3,condition:"累计充值满5000元",minRecharge:5e3,discount:85,description:"大客户，可定期回访与商务交流"},{id:5,name:"超级VIP",level:4,condition:"经理指定",minRecharge:0,discount:0,description:"特殊客户，经理可调整折扣（0-100%）",isCustomDiscount:!0,isEnabled:!0}]),E=l(1),F=l(10),M=l(0),H=l(!1),J=e=>{if(4===e)return"danger";return["","success","warning","danger"][e]||""},N=e=>{const a=Y.value.find((a=>a.level===e));return a?a.name:"未知等级"},A=()=>{E.value=1,de()},G=()=>{_.userId="",_.email="",_.vipLevel="",_.status="",_.dateRange=[],E.value=1,de()},K=l(!1),O=l("add"),Q=l(),W=l("https://cube.elemecdn.com/9/3f/2c0938b93c591b218c1beaf08de07jpeg.jpeg"),X=l(!0),Z=t((()=>X.value?[Y.value.find((e=>4===e.level))]:Y.value.filter((e=>4!==e.level)))),ee=a({userId:"",username:"",nickname:"",password:"",confirmPassword:"",phone:"",email:"",captcha:"",role:0,balance:0,statusBool:!0,rechargeDiscount:0}),ae=a({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{max:20,message:"长度不能超过 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(e,a,l)=>{a!==ee.password?l(new Error("两次输入密码不一致")):l()},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],captcha:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:4,max:6,message:"验证码长度不正确",trigger:"blur"}],role:[{required:!0,message:"请选择会员等级",trigger:"change"}]}),le=()=>{O.value="add",ee.userId="",ee.username="",ee.nickname="",ee.password="",ee.confirmPassword="",ee.email="",ee.captcha="",ee.role=0,ee.balance=0,ee.statusBool=!0,K.value=!0,W.value=`https://cube.elemecdn.com/9/3f/2c0938b93c591b218c1beaf08de07jpeg.jpeg?t=${Date.now()}`,w.success("验证码已刷新")},te=l(0),se=e=>{const a=re(e);te.value=a},re=e=>{for(let a=Y.value.length-1;a>=0;a--){const l=Y.value[a];if(e>=l.minRecharge)return l.level}return 0},ne=e=>{if(X.value&&4!==e)return w.warning("超级VIP功能已启用，只能选择超级VIP"),void(ee.role=4);4!==e||X.value||(w.warning("超级VIP功能已禁用，请选择其他会员等级"),ee.role=3)},oe=e=>{e?(ee.role=4,ee.rechargeDiscount=0,w.success("超级VIP功能已启用，会员等级已设置为超级VIP")):(ee.role=3,w.success("超级VIP功能已禁用，可选择VIP1/2/3等级"))},ue=async()=>{Q.value&&await Q.value.validate(((e,a)=>{e&&("add"===O.value?w.success("新增用户成功"):w.success("编辑用户成功"),K.value=!1)}))},de=()=>{H.value=!0,setTimeout((()=>{const e=$.value.filter((e=>{if(_.userId&&!e.userId.includes(_.userId))return!1;if(_.email&&!e.email.includes(_.email))return!1;if(""!==_.vipLevel&&e.role!==Number(_.vipLevel))return!1;if(_.status){if("normal"===_.status&&"正常"!==e.status)return!1;if("disabled"===_.status&&"禁用"!==e.status)return!1}if(_.dateRange&&2===_.dateRange.length){const a=new Date(_.dateRange[0]),l=new Date(_.dateRange[1]),t=new Date(e.registerTime);if(t<a||t>l)return!1}return!0}));M.value=e.length;const a=(E.value-1)*F.value,l=a+F.value;$.value=e.slice(a,l),H.value=!1}),500)},ie=e=>{F.value=e,de()},ce=e=>{E.value=e,de()};return s([()=>_.userId,()=>_.email,()=>_.vipLevel,()=>_.status,()=>_.dateRange],(()=>{E.value=1,de()})),r((()=>{de()})),(e,a)=>{const l=d("el-button"),t=d("el-input"),s=d("el-form-item"),r=d("el-option"),W=d("el-select"),de=d("el-date-picker"),me=d("el-form"),pe=d("el-table-column"),ge=d("el-tag"),ve=d("el-switch"),be=d("el-table"),fe=d("el-pagination"),he=d("el-card"),Ve=d("el-input-number"),we=d("el-dialog"),Ie=b("loading");return i(),n("div",y,[o(he,{class:"box-card"},{header:u((()=>[c("div",k,[a[19]||(a[19]=c("span",null,"用户管理",-1)),o(l,{type:"primary",onClick:le},{default:u((()=>a[18]||(a[18]=[v("新增用户")]))),_:1})])])),default:u((()=>[a[24]||(a[24]=c("div",{class:"page-description"},[c("p",null,"管理系统的所有用户账号，包括普通用户和各等级VIP会员。用户的会员等级会根据累计充值金额自动调整，您也可以手动设置用户的会员等级和账户余额。")],-1)),c("div",x,[o(me,{inline:!0,model:_,class:"demo-form-inline"},{default:u((()=>[o(s,{label:"用户ID"},{default:u((()=>[o(t,{modelValue:_.userId,"onUpdate:modelValue":a[0]||(a[0]=e=>_.userId=e),placeholder:"请输入用户ID",clearable:""},null,8,["modelValue"])])),_:1}),o(s,{label:"邮箱"},{default:u((()=>[o(t,{modelValue:_.email,"onUpdate:modelValue":a[1]||(a[1]=e=>_.email=e),placeholder:"请输入邮箱",clearable:""},null,8,["modelValue"])])),_:1}),o(s,{label:"会员等级"},{default:u((()=>[o(W,{modelValue:_.vipLevel,"onUpdate:modelValue":a[2]||(a[2]=e=>_.vipLevel=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:u((()=>[o(r,{label:"全部",value:""}),(i(!0),n(p,null,g(Y.value,(e=>(i(),f(r,{key:e.level,label:e.name,value:e.level},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(s,{label:"用户状态"},{default:u((()=>[o(W,{modelValue:_.status,"onUpdate:modelValue":a[3]||(a[3]=e=>_.status=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:u((()=>[o(r,{label:"全部",value:""}),o(r,{label:"正常",value:"normal"}),o(r,{label:"禁用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),o(s,{label:"注册时间"},{default:u((()=>[o(de,{modelValue:_.dateRange,"onUpdate:modelValue":a[4]||(a[4]=e=>_.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),o(s,null,{default:u((()=>[o(l,{type:"primary",onClick:A},{default:u((()=>a[20]||(a[20]=[v("查询")]))),_:1}),o(l,{onClick:G},{default:u((()=>a[21]||(a[21]=[v("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),m((i(),f(be,{data:$.value,style:{width:"100%"},border:"",stripe:""},{default:u((()=>[o(pe,{prop:"userId",label:"用户ID",width:"100"}),o(pe,{prop:"email",label:"邮箱","min-width":"180"}),o(pe,{prop:"nickname",label:"用户昵称",width:"120"}),o(pe,{prop:"role",label:"会员等级",width:"120"},{default:u((e=>[o(ge,{type:J(e.row.role)},{default:u((()=>[v(h(N(e.row.role)),1)])),_:2},1032,["type"])])),_:1}),o(pe,{prop:"balance",label:"账户余额",width:"120"},{default:u((e=>[c("span",U,"¥"+h(e.row.balance),1)])),_:1}),o(pe,{prop:"totalRecharge",label:"累计充值",width:"120"},{default:u((e=>[c("span",P,"¥"+h(e.row.totalRecharge),1)])),_:1}),o(pe,{prop:"totalSpent",label:"累计消费",width:"120"},{default:u((e=>[c("span",R,"¥"+h(e.row.totalSpent),1)])),_:1}),o(pe,{prop:"status",label:"状态",width:"100"},{default:u((e=>[o(ve,{modelValue:e.row.statusBool,"onUpdate:modelValue":a=>e.row.statusBool=a,"active-value":!0,"inactive-value":!1,onChange:a=>((e,a)=>{const l=e?"启用":"禁用";w.success(`用户"${a.username}"已${l}`),a.status=e?"正常":"禁用"})(a,e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"]),c("span",B,h(e.row.statusBool?"正常":"禁用"),1)])),_:1}),o(pe,{prop:"registerTime",label:"注册时间",width:"180"}),o(pe,{label:"操作",width:"160",fixed:"right"},{default:u((e=>[c("div",C,[o(l,{size:"small",type:"primary",onClick:a=>{return l=e.row,O.value="edit",ee.userId=l.userId,ee.nickname=l.nickname,ee.email=l.email,ee.role=l.role,ee.balance=l.balance,ee.statusBool=l.statusBool,ee.rechargeDiscount=l.rechargeDiscount||0,te.value=re(l.balance),void(K.value=!0);var l}},{default:u((()=>a[22]||(a[22]=[v("编辑")]))),_:2},1032,["onClick"]),o(l,{size:"small",type:"danger",onClick:a=>{return l=e.row,void I.confirm(`确定要删除用户"${l.username}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{w({type:"success",message:`用户"${l.username}"已删除`})})).catch((()=>{w({type:"info",message:"已取消删除"})}));var l}},{default:u((()=>a[23]||(a[23]=[v("删除")]))),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])),[[Ie,H.value]]),c("div",D,[o(fe,{"current-page":E.value,"onUpdate:currentPage":a[5]||(a[5]=e=>E.value=e),"page-size":F.value,"onUpdate:pageSize":a[6]||(a[6]=e=>F.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:M.value,onSizeChange:ie,onCurrentChange:ce,background:!0},null,8,["current-page","page-size","total"])])])),_:1}),o(we,{modelValue:K.value,"onUpdate:modelValue":a[17]||(a[17]=e=>K.value=e),title:"add"===O.value?"新增用户":"编辑用户",width:"650px"},{footer:u((()=>[c("span",q,[o(l,{onClick:a[16]||(a[16]=e=>K.value=!1)},{default:u((()=>a[26]||(a[26]=[v("取消")]))),_:1}),o(l,{type:"primary",onClick:ue},{default:u((()=>a[27]||(a[27]=[v("确定")]))),_:1})])])),default:u((()=>[o(me,{model:ee,"label-width":"100px",rules:ae,ref_key:"userFormRef",ref:Q},{default:u((()=>[o(s,{label:"昵称",prop:"nickname"},{default:u((()=>[o(t,{modelValue:ee.nickname,"onUpdate:modelValue":a[7]||(a[7]=e=>ee.nickname=e),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1}),"add"===O.value?(i(),f(s,{key:0,label:"密码",prop:"password"},{default:u((()=>[o(t,{modelValue:ee.password,"onUpdate:modelValue":a[8]||(a[8]=e=>ee.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})):V("",!0),"add"===O.value?(i(),f(s,{key:1,label:"确认密码",prop:"confirmPassword"},{default:u((()=>[o(t,{modelValue:ee.confirmPassword,"onUpdate:modelValue":a[9]||(a[9]=e=>ee.confirmPassword=e),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])])),_:1})):V("",!0),o(s,{label:"邮箱",prop:"email"},{default:u((()=>[o(t,{modelValue:ee.email,"onUpdate:modelValue":a[10]||(a[10]=e=>ee.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),o(s,{label:"超级VIP功能"},{default:u((()=>[o(ve,{modelValue:X.value,"onUpdate:modelValue":a[11]||(a[11]=e=>X.value=e),onChange:oe},null,8,["modelValue"]),c("span",T,h(X.value?"已启用":"已禁用"),1),c("div",L,h(X.value?"启用后只能选择超级VIP":"禁用后可选择VIP1/2/3"),1)])),_:1}),X.value?(i(),f(s,{key:2,label:"充值折扣"},{default:u((()=>[o(Ve,{modelValue:ee.rechargeDiscount,"onUpdate:modelValue":a[12]||(a[12]=e=>ee.rechargeDiscount=e),min:0,max:100,precision:1,step:.1,style:{width:"168px"}},null,8,["modelValue"]),a[25]||(a[25]=c("span",{class:"form-tip"},"%（百分比，可设置0%-100%之间的充值折扣）",-1))])),_:1})):V("",!0),o(s,{label:"会员等级",prop:"role"},{default:u((()=>[o(W,{modelValue:ee.role,"onUpdate:modelValue":a[13]||(a[13]=e=>ee.role=e),placeholder:"请选择会员等级",style:{width:"168px"},onChange:ne,disabled:X.value},{default:u((()=>[(i(!0),n(p,null,g(Z.value,(e=>(i(),f(r,{key:e.level,label:e.name,value:e.level},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"]),X.value?(i(),n("span",S,"超级VIP功能已启用，只能选择超级VIP")):V("",!0),X.value||4!==ee.role?V("",!0):(i(),n("span",z,"超级VIP功能已禁用"))])),_:1}),o(s,{label:"账户余额",prop:"balance"},{default:u((()=>[o(Ve,{modelValue:ee.balance,"onUpdate:modelValue":a[14]||(a[14]=e=>ee.balance=e),min:0,precision:2,step:10,style:{width:"100%"},onChange:se},null,8,["modelValue"])])),_:1}),o(s,{label:"状态"},{default:u((()=>[o(ve,{modelValue:ee.statusBool,"onUpdate:modelValue":a[15]||(a[15]=e=>ee.statusBool=e)},null,8,["modelValue"]),c("span",j,h(ee.statusBool?"正常":"禁用"),1)])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-734f0814"]]);export{$ as default};

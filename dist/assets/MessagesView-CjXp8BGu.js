import{d as e,a,r as l,j as t,K as s,c as d,e as i,w as u,f as o,E as n,o as r,b as c,h as p,k as m,l as v,t as g,s as f,_ as y}from"./index-Lit_3WrB.js";const h={class:"messages-container"},_={class:"card-header"},b={class:"search-area"},w={class:"message-list"},k={class:"action-buttons"},T={class:"pagination-container"},x={class:"message-detail"},C={class:"message-header"},V={class:"message-meta"},N={class:"restock-info"},B={key:0,class:"resolved-info"},q={key:0},z={class:"dialog-footer"},U=y(e({__name:"MessagesView",setup(e,{expose:y}){const U=s(),D=a({status:"",email:"",productName:"",dateRange:[]}),R=l(1),S=l(10),Y=l(100),j=l([{id:1,email:"newshengao@gmail.com",productName:"美国号码",quantity:10,description:"需要更多号码，越快越好",status:"pending",createTime:"2024-03-10 10:30:45"},{id:2,email:"agent001@example.com",productName:"美国号码",quantity:50,description:"客户需要美国号码，急需补货",status:"pending",createTime:"2024-03-07 16:45:10"},{id:3,email:"user123@example.com",productName:"英国号码",quantity:20,description:"需要英国号码用于业务拓展",status:"resolved",createTime:"2024-03-05 09:15:22",resolvedTime:"2024-03-05 11:30:45",resolvedBy:"管理员"},{id:4,email:"customer@example.com",productName:"加拿大号码",quantity:15,description:"客户急需加拿大号码",status:"resolved",createTime:"2024-03-03 14:20:15",resolvedTime:"2024-03-03 16:45:30",resolvedBy:"管理员"},{id:5,email:"business@example.com",productName:"澳大利亚号码",quantity:30,description:"业务扩展需要澳大利亚号码",status:"pending",createTime:"2024-03-01 11:10:05"}]),I=l([]),M=l({id:0,email:"",productName:"",quantity:0,description:"",status:"",createTime:"",resolvedTime:"",resolvedBy:""}),E=l(!1),L=()=>{n.success("搜索条件已应用"),R.value=1},K=()=>{D.status="",D.email="",D.productName="",D.dateRange=[],L()},P=e=>{S.value=e},$=e=>{R.value=e},A=e=>{I.value=e},F=({row:e})=>"pending"===e.status?"pending-row":"",G=e=>{const a=j.value.findIndex((a=>a.id===e.id));-1!==a&&(j.value[a].status="resolved",j.value[a].resolvedTime=(new Date).toLocaleString(),j.value[a].resolvedBy="管理员",M.value.id===e.id&&(M.value.status="resolved",M.value.resolvedTime=j.value[a].resolvedTime,M.value.resolvedBy=j.value[a].resolvedBy),n.success("已标记为已解决"))},H=()=>{if(0===I.value.length)return void n.warning("请选择要标记的补货提醒");const e=I.value.map((e=>e.id)),a=(new Date).toLocaleString();j.value.forEach((l=>{e.includes(l.id)&&"pending"===l.status&&(l.status="resolved",l.resolvedTime=a,l.resolvedBy="管理员")})),n.success(`已将${e.length}条补货提醒标记为已解决`)};return t((()=>{const e=U.query;e.status&&(D.status=e.status,L())})),y({getPendingCount:()=>j.value.filter((e=>"pending"===e.status)).length}),(e,a)=>{const l=o("el-button"),t=o("el-option"),s=o("el-select"),y=o("el-form-item"),U=o("el-input"),J=o("el-date-picker"),O=o("el-form"),Q=o("el-table-column"),W=o("el-tag"),X=o("el-table"),Z=o("el-pagination"),ee=o("el-card"),ae=o("el-descriptions-item"),le=o("el-descriptions"),te=o("el-dialog");return r(),d("div",h,[i(ee,{class:"box-card"},{header:u((()=>[c("div",_,[a[8]||(a[8]=c("span",null,"补货提醒",-1)),i(l,{type:"primary",onClick:H,disabled:0===I.value.length},{default:u((()=>a[7]||(a[7]=[p(" 批量标记已解决 ")]))),_:1},8,["disabled"])])])),default:u((()=>[a[16]||(a[16]=c("div",{class:"page-description"}," 管理用户发来的补货提醒，您可以查看详情并标记为已解决。 ",-1)),c("div",b,[i(O,{inline:!0,model:D,class:"search-form"},{default:u((()=>[i(y,{label:"状态"},{default:u((()=>[i(s,{modelValue:D.status,"onUpdate:modelValue":a[0]||(a[0]=e=>D.status=e),placeholder:"全部状态",clearable:"",style:{width:"168px"}},{default:u((()=>[i(t,{label:"未解决",value:"pending"}),i(t,{label:"已解决",value:"resolved"})])),_:1},8,["modelValue"])])),_:1}),i(y,{label:"用户邮箱"},{default:u((()=>[i(U,{modelValue:D.email,"onUpdate:modelValue":a[1]||(a[1]=e=>D.email=e),placeholder:"用户邮箱"},null,8,["modelValue"])])),_:1}),i(y,{label:"商品名称"},{default:u((()=>[i(U,{modelValue:D.productName,"onUpdate:modelValue":a[2]||(a[2]=e=>D.productName=e),placeholder:"商品名称"},null,8,["modelValue"])])),_:1}),i(y,{label:"时间范围"},{default:u((()=>[i(J,{modelValue:D.dateRange,"onUpdate:modelValue":a[3]||(a[3]=e=>D.dateRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])])),_:1}),i(y,null,{default:u((()=>[i(l,{type:"primary",onClick:L},{default:u((()=>a[9]||(a[9]=[p("查询")]))),_:1}),i(l,{onClick:K},{default:u((()=>a[10]||(a[10]=[p("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),c("div",w,[i(X,{data:j.value,style:{width:"100%"},onSelectionChange:A,"row-class-name":F},{default:u((()=>[i(Q,{type:"selection",width:"55"}),i(Q,{label:"状态",width:"100"},{default:u((e=>["pending"===e.row.status?(r(),m(W,{key:0,type:"danger"},{default:u((()=>a[11]||(a[11]=[p("未解决")]))),_:1})):"resolved"===e.row.status?(r(),m(W,{key:1,type:"success"},{default:u((()=>a[12]||(a[12]=[p("已解决")]))),_:1})):v("",!0)])),_:1}),i(Q,{prop:"email",label:"用户邮箱",width:"200"}),i(Q,{prop:"productName",label:"商品名称","min-width":"150"}),i(Q,{prop:"quantity",label:"需求数量",width:"100"}),i(Q,{prop:"description",label:"备注说明","min-width":"200"}),i(Q,{prop:"createTime",label:"发送时间",width:"180"}),i(Q,{label:"操作",width:"180",fixed:"right"},{default:u((e=>[c("div",k,[i(l,{size:"small",type:"primary",onClick:a=>{return l=e.row,M.value={...l},void(E.value=!0);var l}},{default:u((()=>a[13]||(a[13]=[p("查看")]))),_:2},1032,["onClick"]),i(l,{size:"small",type:"primary",onClick:a=>G(e.row),disabled:"resolved"===e.row.status},{default:u((()=>a[14]||(a[14]=[p("解决")]))),_:2},1032,["onClick","disabled"]),i(l,{size:"small",type:"danger",onClick:a=>{return l=e.row.id,void f.confirm("确定要删除这条补货提醒吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{const e=j.value.findIndex((e=>e.id===l));-1!==e&&j.value.splice(e,1),n.success("删除成功")})).catch((()=>{}));var l}},{default:u((()=>a[15]||(a[15]=[p("删除")]))),_:2},1032,["onClick"])])])),_:1})])),_:1},8,["data"])]),c("div",T,[i(Z,{background:"",layout:"total, sizes, prev, pager, next, jumper",total:Y.value,"page-size":S.value,"current-page":R.value,onSizeChange:P,onCurrentChange:$},null,8,["total","page-size","current-page"])])])),_:1}),i(te,{modelValue:E.value,"onUpdate:modelValue":a[6]||(a[6]=e=>E.value=e),title:"补货提醒详情",width:"600px"},{footer:u((()=>[c("span",z,[i(l,{onClick:a[4]||(a[4]=e=>E.value=!1)},{default:u((()=>a[20]||(a[20]=[p("关闭")]))),_:1}),i(l,{type:"success",onClick:a[5]||(a[5]=e=>G(M.value)),disabled:"resolved"===M.value.status},{default:u((()=>a[21]||(a[21]=[p("标记为已解决")]))),_:1},8,["disabled"])])])),default:u((()=>[c("div",x,[c("div",C,[c("div",V,[c("span",null,"时间: "+g(M.value.createTime),1),"pending"===M.value.status?(r(),m(W,{key:0,type:"danger"},{default:u((()=>a[17]||(a[17]=[p("未解决")]))),_:1})):"resolved"===M.value.status?(r(),m(W,{key:1,type:"success"},{default:u((()=>a[18]||(a[18]=[p("已解决")]))),_:1})):v("",!0)])]),c("div",N,[i(le,{column:1,border:""},{default:u((()=>[i(ae,{label:"用户邮箱"},{default:u((()=>[p(g(M.value.email),1)])),_:1}),i(ae,{label:"商品名称"},{default:u((()=>[p(g(M.value.productName),1)])),_:1}),i(ae,{label:"需求数量"},{default:u((()=>[p(g(M.value.quantity),1)])),_:1}),i(ae,{label:"备注说明"},{default:u((()=>[p(g(M.value.description),1)])),_:1})])),_:1})]),M.value.resolvedTime?(r(),d("div",B,[a[19]||(a[19]=c("h4",null,"解决信息",-1)),c("p",null,"已于 "+g(M.value.resolvedTime)+" 标记为已解决",1),M.value.resolvedBy?(r(),d("p",q,"处理人: "+g(M.value.resolvedBy),1)):v("",!0)])):v("",!0)])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-caf1d21a"]]);export{U as default};

import{d as e,a,r as l,j as s,c as i,e as t,w as n,f as o,E as d,o as r,b as u,H as p,h as m,J as c,k as v,t as y,l as f,s as g,_ as h}from"./index-Lit_3WrB.js";const b={class:"roles-container"},_={class:"card-header"},w={class:"search-area"},T={class:"status-text"},k={class:"action-buttons"},V={class:"pagination-container"},C={class:"status-text"},x={class:"dialog-footer"},B={key:0},I={class:"permission-title"},U={key:0,class:"permission-type-info"},z={class:"dialog-footer"},R=h(e({__name:"RolesView",setup(e){const h=a({name:"",status:""}),R=l([{roleId:"R001",name:"超级管理员",description:"拥有系统所有权限，可以管理所有功能和数据",status:"启用",statusBool:!0,permissionType:"advanced",createTime:"2023-12-01 10:00:00"},{roleId:"R002",name:"普通管理员1",description:"拥有部分管理权限，可以管理部分功能和数据",status:"启用",statusBool:!0,permissionType:"normal",createTime:"2023-12-05 14:30:00"},{roleId:"R003",name:"普通管理员2",description:"拥有部分管理权限，负责内容管理和用户服务",status:"启用",statusBool:!0,permissionType:"normal",createTime:"2023-12-10 09:15:00"},{roleId:"R004",name:"普通管理员3",description:"拥有部分管理权限，负责订单处理和客户服务",status:"启用",statusBool:!0,permissionType:"normal",createTime:"2023-12-15 16:45:00"},{roleId:"R005",name:"普通管理员4",description:"拥有部分管理权限，负责数据分析和报表生成",status:"禁用",statusBool:!1,permissionType:"normal",createTime:"2023-12-20 11:20:00"}]),$=l(1),j=l(10),q=l(100),H=l(!1),K=l(!1),S=l("add"),D=l(),E=a({roleId:"",name:"",description:"",statusBool:!0,permissionType:"normal"}),F=a({name:[{required:!0,message:"请输入角色名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],description:[{required:!0,message:"请输入角色描述",trigger:"blur"},{max:200,message:"长度不能超过 200 个字符",trigger:"blur"}],permissionType:[{required:!0,message:"请选择权限类型",trigger:"change"}]}),J=l(!1),P=l(null),A=l(),G=l([]),L=l([{id:1,name:"数据概览",children:[{id:101,name:"数据概览"}]},{id:2,name:"订单管理",children:[{id:201,name:"商品订单"},{id:202,name:"充值订单"}]},{id:3,name:"商品管理",children:[{id:301,name:"商品列表"},{id:302,name:"分类管理"},{id:303,name:"库存管理"}]},{id:4,name:"用户管理",children:[{id:401,name:"用户管理"}]},{id:5,name:"会员设置",children:[{id:501,name:"会员设置"}]},{id:6,name:"内容管理",children:[{id:601,name:"文档设置"},{id:602,name:"模板设置"},{id:603,name:"站内信"}]},{id:7,name:"权限管理",children:[{id:701,name:"角色管理"},{id:702,name:"账户管理"}]},{id:8,name:"系统管理",children:[{id:801,name:"系统设置"},{id:802,name:"操作日志"}]}]),M=()=>{H.value=!0,setTimeout((()=>{H.value=!1,d.success("查询成功")}),500)},N=()=>{h.name="",h.status=""},O=()=>{S.value="add",E.roleId="",E.name="",E.description="",E.statusBool=!0,E.permissionType="normal",K.value=!0},Q=()=>{if(A.value){A.value.getCheckedKeys(),A.value.getHalfCheckedKeys();P.value&&"normal"===P.value.permissionType&&d.info("普通权限角色的部分操作将受到限制，详见权限说明"),d.success(`角色"${P.value.name}"的权限已更新`),J.value=!1}},W=async()=>{D.value&&await D.value.validate(((e,a)=>{e&&("add"===S.value?d.success("新增角色成功"):d.success("编辑角色成功"),K.value=!1)}))},X=e=>{j.value=e,M()},Y=e=>{$.value=e,M()};return s((()=>{M()})),(e,a)=>{const l=o("el-button"),s=o("el-input"),Z=o("el-form-item"),ee=o("el-option"),ae=o("el-select"),le=o("el-form"),se=o("el-table-column"),ie=o("el-tag"),te=o("el-switch"),ne=o("el-table"),oe=o("el-pagination"),de=o("el-card"),re=o("el-radio"),ue=o("el-radio-group"),pe=o("el-dialog"),me=o("el-alert"),ce=o("el-tree"),ve=c("loading");return r(),i("div",b,[t(de,{class:"box-card"},{header:n((()=>[u("div",_,[a[13]||(a[13]=u("span",null,"角色管理",-1)),t(l,{type:"primary",onClick:O},{default:n((()=>a[12]||(a[12]=[m("新增角色")]))),_:1})])])),default:n((()=>[u("div",w,[t(le,{inline:!0,model:h,class:"demo-form-inline"},{default:n((()=>[t(Z,{label:"角色名称"},{default:n((()=>[t(s,{modelValue:h.name,"onUpdate:modelValue":a[0]||(a[0]=e=>h.name=e),placeholder:"请输入角色名称",clearable:""},null,8,["modelValue"])])),_:1}),t(Z,{label:"角色状态"},{default:n((()=>[t(ae,{modelValue:h.status,"onUpdate:modelValue":a[1]||(a[1]=e=>h.status=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:n((()=>[t(ee,{label:"全部",value:""}),t(ee,{label:"启用",value:"enabled"}),t(ee,{label:"禁用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),t(Z,null,{default:n((()=>[t(l,{type:"primary",onClick:M},{default:n((()=>a[14]||(a[14]=[m("查询")]))),_:1}),t(l,{onClick:N},{default:n((()=>a[15]||(a[15]=[m("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),p((r(),v(ne,{data:R.value,style:{width:"100%"},border:"",stripe:""},{default:n((()=>[t(se,{type:"index",label:"序号",width:"60"}),t(se,{prop:"roleId",label:"角色ID",width:"100"}),t(se,{prop:"name",label:"角色名称",width:"150"}),t(se,{prop:"permissionType",label:"权限类型",width:"120"},{default:n((e=>[t(ie,{type:"advanced"===e.row.permissionType?"success":"warning"},{default:n((()=>[m(y("advanced"===e.row.permissionType?"高级权限":"普通权限"),1)])),_:2},1032,["type"])])),_:1}),t(se,{prop:"description",label:"角色描述","min-width":"200"}),t(se,{prop:"status",label:"状态",width:"100"},{default:n((e=>[t(te,{modelValue:e.row.statusBool,"onUpdate:modelValue":a=>e.row.statusBool=a,"active-value":!0,"inactive-value":!1,disabled:"超级管理员"===e.row.name,onChange:a=>((e,a)=>{if("超级管理员"===a.name)return d.warning("超级管理员角色不能被禁用"),void(a.statusBool=!0);const l=e?"启用":"禁用";d.success(`角色"${a.name}"已${l}`),a.status=e?"启用":"禁用"})(a,e.row)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),u("span",T,y(e.row.statusBool?"启用":"禁用"),1)])),_:1}),t(se,{prop:"createTime",label:"创建时间",width:"180"}),t(se,{label:"操作",width:"180",fixed:"right"},{default:n((e=>[u("div",k,[t(l,{size:"small",type:"primary",onClick:a=>{return l=e.row,S.value="edit",E.roleId=l.roleId,E.name=l.name,E.description=l.description,E.statusBool=l.statusBool,E.permissionType=l.permissionType||"normal",void(K.value=!0);var l}},{default:n((()=>a[16]||(a[16]=[m("编辑")]))),_:2},1032,["onClick"]),t(l,{size:"small",type:"success",onClick:a=>{return l=e.row,P.value=l,"R001"===l.roleId||"advanced"===l.permissionType?G.value=[101,201,202,301,302,303,401,501,601,602,603,701,702,801,802]:"normal"===l.permissionType?G.value=[101,201,202,301,302,303,401,601,602,603]:G.value=[101],void(J.value=!0);var l}},{default:n((()=>a[17]||(a[17]=[m("权限设置")]))),_:2},1032,["onClick"]),"超级管理员"!==e.row.name?(r(),v(l,{key:0,size:"small",type:"danger",onClick:a=>{var l;"超级管理员"!==(l=e.row).name?g.confirm(`确定要删除角色"${l.name}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{d({type:"success",message:`角色"${l.name}"已删除`})})).catch((()=>{d({type:"info",message:"已取消删除"})})):d.warning("超级管理员角色不能被删除")}},{default:n((()=>a[18]||(a[18]=[m("删除")]))),_:2},1032,["onClick"])):f("",!0)])])),_:1})])),_:1},8,["data"])),[[ve,H.value]]),u("div",V,[t(oe,{"current-page":$.value,"onUpdate:currentPage":a[2]||(a[2]=e=>$.value=e),"page-size":j.value,"onUpdate:pageSize":a[3]||(a[3]=e=>j.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:q.value,onSizeChange:X,onCurrentChange:Y,background:!0},null,8,["current-page","page-size","total"])])])),_:1}),t(pe,{modelValue:K.value,"onUpdate:modelValue":a[9]||(a[9]=e=>K.value=e),title:"add"===S.value?"新增角色":"编辑角色",width:"500px"},{footer:n((()=>[u("span",x,[t(l,{onClick:a[8]||(a[8]=e=>K.value=!1)},{default:n((()=>a[23]||(a[23]=[m("取消")]))),_:1}),t(l,{type:"primary",onClick:W},{default:n((()=>a[24]||(a[24]=[m("确定")]))),_:1})])])),default:n((()=>[t(le,{model:E,"label-width":"100px",rules:F,ref_key:"roleFormRef",ref:D},{default:n((()=>[t(Z,{label:"角色名称",prop:"name"},{default:n((()=>[t(s,{modelValue:E.name,"onUpdate:modelValue":a[4]||(a[4]=e=>E.name=e),placeholder:"请输入角色名称"},null,8,["modelValue"])])),_:1}),t(Z,{label:"权限类型",prop:"permissionType"},{default:n((()=>[t(ue,{modelValue:E.permissionType,"onUpdate:modelValue":a[5]||(a[5]=e=>E.permissionType=e)},{default:n((()=>[t(re,{label:"normal"},{default:n((()=>a[19]||(a[19]=[m("普通权限")]))),_:1}),t(re,{label:"advanced"},{default:n((()=>a[20]||(a[20]=[m("高级权限")]))),_:1})])),_:1},8,["modelValue"])])),_:1}),"normal"===E.permissionType?(r(),v(Z,{key:0},{default:n((()=>a[21]||(a[21]=[u("div",{class:"permission-description"},[u("div",{class:"permission-description-title"},"普通权限说明："),u("ul",{class:"permission-description-list"},[u("li",null,"商品订单不可删除，可发货"),u("li",null,"充值订单不可确认支付"),u("li",null,"商品列表可查看，不可上架"),u("li",null,"商品分类可查看不可编辑"),u("li",null,"库存管理可查看，不可编辑"),u("li",null,"用户管理内仅可编辑为vip1权限"),u("li",null,"会员设置不可编辑"),u("li",null,"内容管理相关可编辑"),u("li",null,"站内信仅可查看")])],-1)]))),_:1})):"advanced"===E.permissionType?(r(),v(Z,{key:1},{default:n((()=>a[22]||(a[22]=[u("div",{class:"permission-description"},[u("div",{class:"permission-description-title"},"高级权限说明："),u("p",null,"高级权限支持项目内所有操作，无任何限制。")],-1)]))),_:1})):f("",!0),t(Z,{label:"角色描述",prop:"description"},{default:n((()=>[t(s,{modelValue:E.description,"onUpdate:modelValue":a[6]||(a[6]=e=>E.description=e),type:"textarea",rows:3,placeholder:"请输入角色描述"},null,8,["modelValue"])])),_:1}),t(Z,{label:"角色状态"},{default:n((()=>[t(te,{modelValue:E.statusBool,"onUpdate:modelValue":a[7]||(a[7]=e=>E.statusBool=e)},null,8,["modelValue"]),u("span",C,y(E.statusBool?"启用":"禁用"),1)])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"]),t(pe,{modelValue:J.value,"onUpdate:modelValue":a[11]||(a[11]=e=>J.value=e),title:"权限设置",width:"700px"},{footer:n((()=>[u("span",z,[t(l,{onClick:a[10]||(a[10]=e=>J.value=!1)},{default:n((()=>a[25]||(a[25]=[m("取消")]))),_:1}),t(l,{type:"primary",onClick:Q},{default:n((()=>a[26]||(a[26]=[m("保存")]))),_:1})])])),default:n((()=>{return[P.value?(r(),i("div",B,[u("p",I,"当前角色: "+y(P.value.name),1),P.value.permissionType?(r(),i("div",U,[t(me,{title:"advanced"===P.value.permissionType?"高级权限":"普通权限",type:"advanced"===P.value.permissionType?"success":"warning",description:(e=P.value.permissionType,"advanced"===e?"高级权限支持项目内所有操作，无任何限制。":"普通权限有特定的操作限制，详见权限说明。"),"show-icon":"",closable:!1},null,8,["title","type","description"])])):f("",!0),t(ce,{ref_key:"permissionTreeRef",ref:A,data:L.value,"show-checkbox":"","node-key":"id","default-checked-keys":G.value,props:{label:"name",children:"children"},disabled:"超级管理员"===P.value.name},null,8,["data","default-checked-keys","disabled"])])):f("",!0)];var e})),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-85bfb181"]]);export{R as default};

import{d as e,a,r as l,n as r,j as s,c as o,e as t,w as u,f as d,o as n,b as i,H as m,F as c,D as p,h as v,J as g,k as f,t as b,l as w,E as h,s as V,_}from"./index-Lit_3WrB.js";const k={class:"accounts-container"},y={class:"card-header"},x={class:"search-area"},I={class:"status-text"},B={class:"action-buttons"},U={class:"pagination-container"},C={class:"status-text"},N={class:"dialog-footer"},T=_(e({__name:"AccountsView",setup(e){const _=a({accountId:"",username:"",role:"",status:""}),T=l([{value:"超级管理员",label:"超级管理员"},{value:"管理员",label:"管理员"},{value:"运营",label:"运营"},{value:"客服",label:"客服"},{value:"财务",label:"财务"}]),z=l([{accountId:"A10001",username:"admin",realName:"张三",role:"超级管理员",email:"admin@example.com",phone:"138****1234",lastLoginTime:"2024-03-15 08:30:00",status:"正常",statusBool:!0,remark:"系统超级管理员",permissions:["data","orders","products","categories","users","members","templates","settings"]},{accountId:"A10002",username:"operator",realName:"李四",role:"运营",email:"operator@example.com",phone:"139****5678",lastLoginTime:"2024-03-14 16:45:00",status:"正常",statusBool:!0,remark:"负责日常运营工作",permissions:["data","orders","products","categories","users"]},{accountId:"A10003",username:"service",realName:"王五",role:"客服",email:"service@example.com",phone:"137****9012",lastLoginTime:"2024-03-15 09:15:00",status:"正常",statusBool:!0,remark:"负责客户服务",permissions:["data","orders","users"]},{accountId:"A10004",username:"finance",realName:"赵六",role:"财务",email:"finance@example.com",phone:"136****3456",lastLoginTime:"2024-03-14 14:20:00",status:"正常",statusBool:!0,remark:"负责财务管理",permissions:["data","orders"]},{accountId:"A10005",username:"test",realName:"测试账号",role:"管理员",email:"test@example.com",phone:"135****7890",lastLoginTime:"2024-03-10 11:30:00",status:"禁用",statusBool:!1,remark:"测试账号，已禁用",permissions:["data","orders","products","categories","users","members","templates"]}]),P=l(1),A=l(10),L=l(0),q=l(!1),D=()=>{P.value=1,G()},$=()=>{_.accountId="",_.username="",_.role="",_.status="",P.value=1,G()},j=l(!1),E=l("add"),F=l(),S=a({accountId:"",username:"",realName:"",password:"",confirmPassword:"",phone:"",email:"",role:"",permissions:[],statusBool:!0,remark:""}),H=a({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"长度在 6 到 20 个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:(e,a,l)=>{a!==S.password?l(new Error("两次输入密码不一致")):l()},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}],remark:[{max:200,message:"长度不能超过 200 个字符",trigger:"blur"}]}),J=()=>{E.value="add",S.accountId="",S.username="",S.realName="",S.password="",S.confirmPassword="",S.phone="",S.email="",S.role="",S.permissions=[],S.statusBool=!0,S.remark="",j.value=!0},R=async()=>{F.value&&await F.value.validate(((e,a)=>{e&&("add"===E.value?h.success("新增账户成功"):h.success("编辑账户成功"),j.value=!1)}))},G=()=>{q.value=!0,setTimeout((()=>{const e=z.value.filter((e=>{if(_.accountId&&!e.accountId.includes(_.accountId))return!1;if(_.username&&!e.username.includes(_.username))return!1;if(_.role&&e.role!==_.role)return!1;if(_.status){if("normal"===_.status&&"正常"!==e.status)return!1;if("disabled"===_.status&&"禁用"!==e.status)return!1}return!0}));L.value=e.length;const a=(P.value-1)*A.value,l=a+A.value;z.value=e.slice(a,l),q.value=!1}),500)},K=e=>{A.value=e,G()},M=e=>{P.value=e,G()};return r([()=>_.accountId,()=>_.username,()=>_.role,()=>_.status],(()=>{P.value=1,G()})),s((()=>{G()})),(e,a)=>{const l=d("el-button"),r=d("el-input"),s=d("el-form-item"),G=d("el-option"),O=d("el-select"),Q=d("el-form"),W=d("el-table-column"),X=d("el-tag"),Y=d("el-switch"),Z=d("el-table"),ee=d("el-pagination"),ae=d("el-card"),le=d("el-dialog"),re=g("loading");return n(),o("div",k,[t(ae,{class:"box-card"},{header:u((()=>[i("div",y,[a[16]||(a[16]=i("span",null,"账户管理",-1)),t(l,{type:"primary",onClick:J},{default:u((()=>a[15]||(a[15]=[v("新增账户")]))),_:1})])])),default:u((()=>[a[21]||(a[21]=i("div",{class:"page-description"},[i("p",null,"管理系统的后台账户，包括管理员和操作员。您可以为不同角色的管理人员创建账户，并分配相应的权限。")],-1)),i("div",x,[t(Q,{inline:!0,model:_,class:"demo-form-inline"},{default:u((()=>[t(s,{label:"账户ID"},{default:u((()=>[t(r,{modelValue:_.accountId,"onUpdate:modelValue":a[0]||(a[0]=e=>_.accountId=e),placeholder:"请输入账户ID",clearable:""},null,8,["modelValue"])])),_:1}),t(s,{label:"用户名"},{default:u((()=>[t(r,{modelValue:_.username,"onUpdate:modelValue":a[1]||(a[1]=e=>_.username=e),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])])),_:1}),t(s,{label:"角色"},{default:u((()=>[t(O,{modelValue:_.role,"onUpdate:modelValue":a[2]||(a[2]=e=>_.role=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:u((()=>[t(G,{label:"全部",value:""}),(n(!0),o(c,null,p(T.value,(e=>(n(),f(G,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),t(s,{label:"状态"},{default:u((()=>[t(O,{modelValue:_.status,"onUpdate:modelValue":a[3]||(a[3]=e=>_.status=e),placeholder:"请选择",clearable:"",style:{width:"168px"}},{default:u((()=>[t(G,{label:"全部",value:""}),t(G,{label:"正常",value:"normal"}),t(G,{label:"禁用",value:"disabled"})])),_:1},8,["modelValue"])])),_:1}),t(s,null,{default:u((()=>[t(l,{type:"primary",onClick:D},{default:u((()=>a[17]||(a[17]=[v("查询")]))),_:1}),t(l,{onClick:$},{default:u((()=>a[18]||(a[18]=[v("重置")]))),_:1})])),_:1})])),_:1},8,["model"])]),m((n(),f(Z,{data:z.value,style:{width:"100%"},border:"",stripe:""},{default:u((()=>[t(W,{prop:"accountId",label:"账户ID",width:"100"}),t(W,{prop:"username",label:"用户名",width:"120"}),t(W,{prop:"role",label:"角色",width:"120"},{default:u((e=>{return[t(X,{type:(a=e.row.role,{"超级管理员":"danger","管理员":"warning","运营":"success","客服":"info","财务":"primary"}[a]||"info")},{default:u((()=>[v(b(e.row.role),1)])),_:2},1032,["type"])];var a})),_:1}),t(W,{prop:"email",label:"邮箱","min-width":"180"}),t(W,{prop:"lastLoginTime",label:"最后登录时间",width:"180"}),t(W,{prop:"remark",label:"备注","min-width":"150"}),t(W,{prop:"status",label:"状态",width:"100"},{default:u((e=>[t(Y,{modelValue:e.row.statusBool,"onUpdate:modelValue":a=>e.row.statusBool=a,"active-value":!0,"inactive-value":!1,disabled:"超级管理员"===e.row.role,onChange:a=>((e,a)=>{if("超级管理员"===a.role)return h.warning("超级管理员账户不能被禁用"),void(a.statusBool=!0);const l=e?"启用":"禁用";h.success(`账户"${a.username}"已${l}`),a.status=e?"正常":"禁用"})(a,e.row)},null,8,["modelValue","onUpdate:modelValue","disabled","onChange"]),i("span",I,b(e.row.statusBool?"正常":"禁用"),1)])),_:1}),t(W,{label:"操作",width:"160",fixed:"right"},{default:u((e=>[i("div",B,[t(l,{size:"small",type:"primary",onClick:a=>{return l=e.row,E.value="edit",S.accountId=l.accountId,S.username=l.username,S.realName=l.realName,S.phone=l.phone,S.email=l.email,S.role=l.role,S.permissions=[...l.permissions],S.statusBool=l.statusBool,S.remark=l.remark||"",void(j.value=!0);var l}},{default:u((()=>a[19]||(a[19]=[v("编辑")]))),_:2},1032,["onClick"]),"超级管理员"!==e.row.role?(n(),f(l,{key:0,size:"small",type:"danger",onClick:a=>{var l;"超级管理员"!==(l=e.row).role?V.confirm(`确定要删除账户"${l.username}"吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{h({type:"success",message:`账户"${l.username}"已删除`})})).catch((()=>{h({type:"info",message:"已取消删除"})})):h.warning("超级管理员账户不能被删除")}},{default:u((()=>a[20]||(a[20]=[v("删除")]))),_:2},1032,["onClick"])):w("",!0)])])),_:1})])),_:1},8,["data"])),[[re,q.value]]),i("div",U,[t(ee,{"current-page":P.value,"onUpdate:currentPage":a[4]||(a[4]=e=>P.value=e),"page-size":A.value,"onUpdate:pageSize":a[5]||(a[5]=e=>A.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:L.value,onSizeChange:K,onCurrentChange:M,background:!0},null,8,["current-page","page-size","total"])])])),_:1}),t(le,{modelValue:j.value,"onUpdate:modelValue":a[14]||(a[14]=e=>j.value=e),title:"add"===E.value?"新增账户":"编辑账户",width:"650px"},{footer:u((()=>[i("span",N,[t(l,{onClick:a[13]||(a[13]=e=>j.value=!1)},{default:u((()=>a[22]||(a[22]=[v("取消")]))),_:1}),t(l,{type:"primary",onClick:R},{default:u((()=>a[23]||(a[23]=[v("确定")]))),_:1})])])),default:u((()=>[t(Q,{model:S,"label-width":"100px",rules:H,ref_key:"accountFormRef",ref:F},{default:u((()=>[t(s,{label:"用户名",prop:"username"},{default:u((()=>[t(r,{modelValue:S.username,"onUpdate:modelValue":a[6]||(a[6]=e=>S.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),"add"===E.value||"edit"===E.value&&"超级管理员"!==S.role?(n(),f(s,{key:0,label:"密码",prop:"password"},{default:u((()=>[t(r,{modelValue:S.password,"onUpdate:modelValue":a[7]||(a[7]=e=>S.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})):w("",!0),"add"===E.value||"edit"===E.value&&"超级管理员"!==S.role?(n(),f(s,{key:1,label:"确认密码",prop:"confirmPassword"},{default:u((()=>[t(r,{modelValue:S.confirmPassword,"onUpdate:modelValue":a[8]||(a[8]=e=>S.confirmPassword=e),type:"password",placeholder:"请再次输入密码"},null,8,["modelValue"])])),_:1})):w("",!0),t(s,{label:"邮箱",prop:"email"},{default:u((()=>[t(r,{modelValue:S.email,"onUpdate:modelValue":a[9]||(a[9]=e=>S.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),t(s,{label:"角色",prop:"role"},{default:u((()=>[t(O,{modelValue:S.role,"onUpdate:modelValue":a[10]||(a[10]=e=>S.role=e),placeholder:"请选择角色",style:{width:"168px"}},{default:u((()=>[(n(!0),o(c,null,p(T.value,(e=>(n(),f(G,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),t(s,{label:"状态"},{default:u((()=>[t(Y,{modelValue:S.statusBool,"onUpdate:modelValue":a[11]||(a[11]=e=>S.statusBool=e),disabled:"超级管理员"===S.role},null,8,["modelValue","disabled"]),i("span",C,b(S.statusBool?"正常":"禁用"),1)])),_:1}),t(s,{label:"备注",prop:"remark"},{default:u((()=>[t(r,{modelValue:S.remark,"onUpdate:modelValue":a[12]||(a[12]=e=>S.remark=e),type:"textarea",rows:3,placeholder:"请输入备注信息"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-062f3f4c"]]);export{T as default};
